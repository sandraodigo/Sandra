---
title: "Machine_Learning_Predictions for Google, Underinsured and Uninsured"
author: "Sandra Odigo"
date: "7/01/2020"
output: html_document
---


#Load Required Libraries 
```{r setup, include=FALSE}
library(forecast)
library(dplyr)
library(ggplot2)
library(tibble)
library(caret)
library(randomForest)
library(rattle)
library(rpart)
library(rpart.plot)
```

#Load Data 
```{r}
filePath<- "/Users/SandraOdigo/Desktop/Loyola University/Quarter 4/Capstone/Project_Data"
EmpSpon<- read.csv(paste0(filePath, '/EmpSponClean.csv'))
RateMedi<- read.csv(paste0(filePath, '/RateMediClean.csv'))
PvtFirmCov<- read.csv(paste0(filePath, '/PvtFirmsInsCoverage.csv'))
PvtFirmCov<- read.csv(paste0(filePath, '/PvtFirmsInsCoverage.csv'))
Age_Num <- read.csv(paste(filePath,"Uninsured_by_Age_Numbers.csv", sep = "/"))
Age_Pct <- read.csv(paste(filePath,"Uninsured_by_Age_Percent.csv", sep = "/"))
Eth_Num <- read.csv(paste(filePath,"Uninsured_by_Ethnicity_Numbers.csv", sep = "/"))
Eth_Pct <- read.csv(paste(filePath,"Uninsured_by_Ethnicity_Percent.csv", sep = "/"))
Work_Status <- read.csv(paste(filePath,"Uninsured by Family Work Status.csv", sep = "/"))
gen1 <- read.csv(paste(filePath,"health_insurance_coverage_by_gender.csv", sep = "/"))
google <- read.csv(paste(filePath, "/google_search_kw.csv", sep = "/"))
```


#Clean Installs Data
```{r}
df2 <- df1[,c(2:4,13:14,16,43:48,51,54:59,64,79)]

df2$device_category[is.na(df2$device_category)] <- "phone"   ##converts 11671 nulls to "phone", which is mode with 103986 values
df2$country[is.na(df2$country)] <- "US"   ##converts 1 null to "US", which is mode with 113536 values
df2$state[is.na(df2$state)] <- "AR"   ##converts 5 nulls to "AR", which is based on country/state analysis of those 5nulls
df2$campaign[is.na(df2$campaign)] <- "Discovery_Exact"   ##converts 21 nulls to "Discovery_Exact", which is based on analysis of campaign_id vs campaign

summary(df2$channel)
#channel has 48722 nulls. UAC_Display is mode with only 45375 values
#No other columns have any nulls remaining

clean_installs <- na.omit(df2)
write.csv(clean_installs, file = "Installs_new_clean.csv", row.names = FALSE)
```


#Random Forest
```{r}
#Subset to Keywords that have a Freq Count Over 80
# See the counts of each keyword
test <- as.data.frame(table(google_freq$Keyword))

# Filter with a freq over 80  
google_key <- filter(test, test$Freq >= 80)
# filter the original data set with the keywords that match google_key
google_80 <- google_freq %>% filter(Keyword %in% google_key$Var1)
#Fix the Factor for Keyword
google_80$Keyword <- factor(google_80$Keyword)
str(google_80)

#Split into Train and Test
#To ensure the random integers are pulled from the same set of numbers
set.seed(737900)
# Split 70% of data into train and 30% into test
splitIndex <- sample(nrow(google_80), size=(.7*nrow(google_80)), replace=F)
#Select only those rows in splitIndex and assign to the trainDF
trainDF <- google_80[splitIndex,]
#Select the rows not in splitIndex and assign to the testDF
testDF <- google_80[-splitIndex,]

#Train
set.seed(737900)
rf1 <- randomForest(formula=Clicks ~ Keyword + Impr. + Cost , data=trainDF, importance = TRUE)
# calcuating rsquared for the trees
rf1$rsq

#Test
# create a data frame with the predictions
test <- data.frame(predict(rf1, newdata = testDF))
# combine with the original df for the test set
test2 <- cbind(testDF, test)
head(test2)
```

#Subset for clicks over 100
```{r}
# Filter for clicks over 100
google_clicks <- filter(google, google$Clicks >= 100)
google_clicks$Keyword <- factor(google_clicks$Keyword)

#Split into Train and Test
#To ensure the random integers are pulled from the same set of numbers
set.seed(737900)
# Split 70% of data into train and 30% into test
splitIndex2 <- sample(nrow(google_clicks), size=(.7*nrow(google_clicks)), replace=F)
#Select only those rows in splitIndex and assign to the trainDF
trainDF2 <- google_clicks[splitIndex2,]
#Select the rows not in splitIndex and assign to the testDF
testDF2 <- google_clicks[-splitIndex2,]

#Train
set.seed(737900)
rf2 <- randomForest(formula=Clicks ~ Keyword + Impr. + Cost , data=trainDF2, importance = TRUE)
# r squared for the trees
rf2$rsq

#Test
# create a data frame with the predictions
test2 <- data.frame(predict(rf2, newdata = testDF2))
# combine with the original df for the test set
predicted_val <- cbind(testDF2, test2)
```

# Cleaning in R
## Uninsured cleaning
```{r}
gen2 <- gen1[order(gen1$Gender),]
gen2$Employer <- as.numeric(gen2$Employer)
Female <- gen2[1:583,c(2:3,5:11)]
Male <- gen2[584:1166,c(2:3,5:11)]

colnames(Age_Num)<-c("Location","Year","Num.Children.0.18","Num.Adults.19.64","Age.Num.Total")
colnames(Age_Pct)<-c("Location","Year","Pct.Children.0.18","Pct.Adults.19.64","Age.Pct.Total")
colnames(Eth_Num)<-c("Location","Year","Num.White","Num.Black","Num.Hispanic","Num.Asian.Native.Hawaiian.and.Pacific.Islander","Num.American.Indian.Alaska.Native","Num.Multiple.Races","Eth.Num.Total")
colnames(Eth_Pct)<-c("Location","Year","Pct.White","Pct.Black","Pct.Hispanic","Pct.Asian.Native.Hawaiian.and.Pacific.Islander","Pct.American.Indian.Alaska.Native","Pct.Multiple.Races","Eth.Pct.Total")
colnames(Work_Status)[6]<-c("WS.Total")
colnames(Male)[3:9]<-c("Male.Employer","Male.Non.Group","Male.Medicaid","Male.Medicare","Male.Military","Male.Uninsured","Male.Total")
colnames(Female)[3:9]<-c("Female.Employer","Female.Non.Group","Female.Medicaid","Female.Medicare","Female.Military","Female.Uninsured","Female.Total")

temp1 <- merge(Age_Num, Age_Pct, by = c("Location","Year"))
temp2 <- merge(temp1, Eth_Num, by = c("Location","Year"))
temp3 <- merge(temp2, Eth_Pct, by = c("Location","Year"))
temp4 <- merge(temp3, Work_Status, by = c("Location","Year"))
temp5 <- merge(temp4, Male, by = c("Location","Year"))
Uninsured <- merge(temp5, Female, by = c("Location","Year"))

write.csv(Uninsured, file = "Uninsured_age_eth_work_gend.csv", row.names = FALSE)
```

# Uninsured Forecasting
## Initial preparation
```{r}
Eth_Num <- read.csv(paste(file_dir,"Uninsured_by_Ethnicity_Numbers.csv", sep = "/"))
Eth_Pct <- read.csv(paste(file_dir,"Uninsured_by_Ethnicity_Percent.csv", sep = "/"))
Pop_Eth <- read.csv(paste(file_dir,"Population_by_ethnicity.csv", sep = "/"))

colnames(Eth_Num)<-c("Location","Year","Num.White","Num.Black","Num.Hispanic","Num.Asian.Native.Hawaiian.and.Pacific.Islander","Num.American.Indian.Alaska.Native","Num.Multiple.Races","Eth.Num.Total")
colnames(Eth_Pct)<-c("Location","Year","Pct.White","Pct.Black","Pct.Hispanic","Pct.Asian.Native.Hawaiian.and.Pacific.Islander","Pct.American.Indian.Alaska.Native","Pct.Multiple.Races","Eth.Pct.Total")
colnames(Pop_Eth)<-c("Location","Year","Total.White","Total.Black","Total.Hispanic","Total.Asian.Native.Hawaiian.and.Pacific.Islander","Total.American.Indian.Alaska.Native","Total.Multiple.Races","Total")

temp1 <- merge(Eth_Pct, Eth_Num, by = c("Location","Year"))
Ethnicity <- merge(temp1, Pop_Eth, by = c("Location","Year"))

Alabama <- ts(Ethnicity[1:11,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Alaska <- ts(Ethnicity[12:22,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Arizona <- ts(Ethnicity[23:33,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Arkansas <- ts(Ethnicity[34:44,-c(1:2)], start = 2008, end = 2018, frequency = 1)
California <- ts(Ethnicity[45:55,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Colorado <- ts(Ethnicity[56:66,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Connecticut <- ts(Ethnicity[67:77,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Delaware <- ts(Ethnicity[78:88,-c(1:2)], start = 2008, end = 2018, frequency = 1)
DistrictC <- ts(Ethnicity[89:99,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Florida <- ts(Ethnicity[100:110,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Georgia <- ts(Ethnicity[111:121,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Hawaii <- ts(Ethnicity[122:132,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Idaho <- ts(Ethnicity[133:143,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Illinois <- ts(Ethnicity[144:154,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Indiana <- ts(Ethnicity[155:165,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Iowa <- ts(Ethnicity[166:176,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Kansas <- ts(Ethnicity[177:187,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Kentucky <- ts(Ethnicity[188:198,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Louisiana <- ts(Ethnicity[199:209,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Maine <- ts(Ethnicity[210:220,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Maryland <- ts(Ethnicity[221:231,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Massachusetts <- ts(Ethnicity[232:242,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Michigan <- ts(Ethnicity[243:253,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Minnesota <- ts(Ethnicity[254:264,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Mississippi <- ts(Ethnicity[265:275,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Missouri <- ts(Ethnicity[276:286,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Montana <- ts(Ethnicity[287:297,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Nebraska <- ts(Ethnicity[298:308,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Nevada <- ts(Ethnicity[309:319,-c(1:2)], start = 2008, end = 2018, frequency = 1)
New_Hampshire <- ts(Ethnicity[320:330,-c(1:2)], start = 2008, end = 2018, frequency = 1)
New_Jersey <- ts(Ethnicity[331:341,-c(1:2)], start = 2008, end = 2018, frequency = 1)
New_Mexico <- ts(Ethnicity[342:352,-c(1:2)], start = 2008, end = 2018, frequency = 1)
New_York <- ts(Ethnicity[353:363,-c(1:2)], start = 2008, end = 2018, frequency = 1)
North_Carolina <- ts(Ethnicity[364:374,-c(1:2)], start = 2008, end = 2018, frequency = 1)
North_Dakota <- ts(Ethnicity[375:385,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Ohio <- ts(Ethnicity[386:396,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Oklahoma <- ts(Ethnicity[397:407,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Oregon <- ts(Ethnicity[408:418,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Pennsylvania <- ts(Ethnicity[419:429,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Puerto_Rico <- ts(Ethnicity[430:440,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Rhode_Island <- ts(Ethnicity[441:451,-c(1:2)], start = 2008, end = 2018, frequency = 1)
South_Carolina <- ts(Ethnicity[452:462,-c(1:2)], start = 2008, end = 2018, frequency = 1)
South_Dakota <- ts(Ethnicity[463:473,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Tennessee <- ts(Ethnicity[474:484,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Texas <- ts(Ethnicity[485:495,-c(1:2)], start = 2008, end = 2018, frequency = 1)
United_States_entire <- ts(Ethnicity[496:506,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Utah <- ts(Ethnicity[507:517,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Vermont <- ts(Ethnicity[518:528,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Virginia <- ts(Ethnicity[529:539,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Washington <- ts(Ethnicity[540:550,-c(1:2)], start = 2008, end = 2018, frequency = 1)
West_Virginia <- ts(Ethnicity[551:561,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Wisconsin <- ts(Ethnicity[562:572,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Wyoming <- ts(Ethnicity[573:583,-c(1:2)], start = 2008, end = 2018, frequency = 1)
```

## Uninsured Forecasting broad United States ethnicity
```{r message=FALSE, warning=FALS}
US_white <- United_States_entire[,"Num.White"]

us_w_ses <- ses(US_white, alpha = 0.5, initial = "simple", h = 5)
plot(us_w_ses, plot.conf=FALSE, type="o")
lines(fitted(us_w_ses), col="blue", type="o")
res_uw_ses=residuals(us_w_ses)
Box.test(res_uw_ses,type="L")

us_w_holt <- holt(US_white, alpha = 0.8, beta = 0.2, initial = "simple", h = 5)
plot(us_w_holt, plot.conf=FALSE, type="o")
lines(fitted(us_w_holt), col="blue", type="o")
res_uw_holt=residuals(us_w_holt)
Box.test(res_uw_holt,type="L")

US_hispanic <- United_States_entire[,"Num.Hispanic"]

us_h_ses <- ses(US_hispanic, alpha = 0.5, initial = "simple", h = 5)
plot(us_h_ses, plot.conf=FALSE, type="o")
lines(fitted(us_h_ses), col="blue", type="o")
res_uh_ses=residuals(us_h_ses)
Box.test(res_uh_ses)

us_h_holt <-holt(US_hispanic, alpha = 0.8, beta = 0.2, initial = "simple", h = 5)
plot(us_h_holt, plot.conf=FALSE, type="o")
lines(fitted(us_h_holt), col="blue", type="o")
res_uh_holt=residuals(us_h_holt)
Box.test(res_uh_holt,type="L")

US_black <- United_States_entire[,"Num.Black"]

us_b_ses <- ses(US_black, alpha = 0.5, initial = "simple", h = 5)
plot(us_b_ses, plot.conf=FALSE, type="o")
lines(fitted(us_b_ses), col="blue", type="o")
res_ub_ses=residuals(us_b_ses)
Box.test(res_ub_ses)

us_b_holt <-holt(US_black, alpha = 0.8, beta = 0.2, initial = "simple", h = 5)
plot(us_b_holt, plot.conf=FALSE, type="o")
lines(fitted(us_b_holt), col="blue", type="o")
res_ub_holt=residuals(us_b_holt)
Box.test(res_ub_holt,type="L")

US_asian <- United_States_entire[,"Num.Asian.Native.Hawaiian.and.Pacific.Islander"]

us_a_ses <- ses(US_asian, alpha = 0.5, initial = "simple", h = 5)
plot(us_a_ses, plot.conf=FALSE, type="o")
lines(fitted(us_a_ses), col="blue", type="o")
res_ua_ses=residuals(us_a_ses)
Box.test(res_ua_ses)

us_a_holt <-holt(US_asian, alpha = 0.8, beta = 0.2, initial = "simple", h = 5)
plot(us_a_holt, plot.conf=FALSE, type="o")
lines(fitted(us_a_holt), col="blue", type="o")
res_ua_holt=residuals(us_a_holt)
Box.test(res_ua_holt,type="L")

US_am_indian <- United_States_entire[,"Num.American.Indian.Alaska.Native"]

us_ai_ses <- ses(US_am_indian, alpha = 0.5, initial = "simple", h = 5)
plot(us_ai_ses, plot.conf=FALSE, type="o")
lines(fitted(us_ai_ses), col="blue", type="o")
res_uai_ses=residuals(us_ai_ses)
Box.test(res_uai_ses)

us_ai_holt <-holt(US_am_indian, alpha = 0.8, beta = 0.2, initial = "simple", h = 5)
plot(us_ai_holt, plot.conf=FALSE, type="o")
lines(fitted(us_ai_holt), col="blue", type="o")
res_uai_holt=residuals(us_ai_holt)
Box.test(res_uai_holt,type="L")

US_mult <- United_States_entire[,"Num.Multiple.Races"]

us_m_ses <- ses(US_mult, alpha = 0.5, initial = "simple", h = 5)
plot(us_m_ses, plot.conf=FALSE, type="o")
lines(fitted(us_m_ses), col="blue", type="o")
res_um_ses=residuals(us_m_ses)
Box.test(res_um_ses)

us_m_holt <-holt(US_mult, alpha = 0.8, beta = 0.2, initial = "simple", h = 5)
plot(us_m_holt, plot.conf=FALSE, type="o")
lines(fitted(us_m_holt), col="blue", type="o")
res_um_holt=residuals(us_m_holt)
Box.test(res_um_holt,type="L")
```

## Uninsured Forecasting Gender forecasts
```{r message=FALSE, warning=FALSE}
gen1 <- read.csv(paste(file_dir,"health_insurance_coverage_by_gender.csv", sep = "/"))
gen2 <- gen1[order(gen1$Gender),]
gen2$Employer <- as.numeric(gen2$Employer)
women <- gen2[1:583,c(2:3,5:11)]
men <- gen2[584:1166,c(2:3,5:11)]
Male <- men[order(men$Location),]
Female <- women[order(women$Location),]
Male_ts <- ts(Male[496:506,"Uninsured"], start = 2008, end = 2018, frequency = 1)
Female_ts <- ts(Female[496:506,"Uninsured"], start = 2008, end = 2018, frequency = 1)

male_ses <- ses(Male_ts, alpha = 0.5, initial = "simple", h = 5)
plot(male_ses, plot.conf=FALSE, type="o")
lines(fitted(male_ses), col="blue", type="o")
res_m_ses=residuals(male_ses)
Box.test(res_m_ses,type="L")

male_holt = holt(Male_ts, alpha = 0.8, beta = 0.2, initial = "simple", h = 5)
plot(male_holt, plot.conf=FALSE, type="o")
lines(fitted(male_holt), col="blue", type="o")
res_m_holt=residuals(male_holt)
Box.test(res_m_holt,type="L")

female_ses <- ses(Female_ts, alpha = 0.5, initial = "simple", h = 5)
plot(female_ses, plot.conf=FALSE, type="o")
lines(fitted(male_ses), col="blue", type="o")
res_f_ses=residuals(female_ses)
Box.test(res_f_ses,type="L")

female_holt = holt(Female_ts, alpha = 0.8, beta = 0.2, initial = "simple", h = 5)
plot(female_holt, plot.conf=FALSE, type="o")
lines(fitted(female_holt), col="blue", type="o")
res_f_holt=residuals(female_holt)
Box.test(res_f_holt,type="L")
```

## Uninsured Forecasting Texas
```{r message=FALSE, warning=FALSE}
Texas_hispanic <- Texas[,"Num.Hispanic"]

tx_h_ses <- ses(Texas_hispanic, alpha = 0.5, initial = "simple", h = 5)
plot(tx_h_ses, plot.conf=FALSE, type="o")
lines(fitted(tx_h_ses), col="blue", type="o")
res_txh_ses=residuals(tx_h_ses)
Box.test(res_txh_ses)

tx_h_holt <-holt(Texas_hispanic, alpha = 0.8, beta = 0.2, initial = "simple", h = 5)
plot(tx_h_holt, plot.conf=FALSE, type="o")
lines(fitted(tx_h_holt), col="blue", type="o")
res_txh_holt=residuals(tx_h_holt)
Box.test(res_txh_holt,type="L")

tx_white <- Texas[,"Num.White"]

tx_w_ses <- ses(tx_white, alpha = 0.5, initial = "simple", h = 5)
plot(tx_w_ses, plot.conf=FALSE, type="o")
lines(fitted(tx_w_ses), col="blue", type="o")
res_txw_ses=residuals(tx_w_ses)
Box.test(res_txw_ses,type="L")

tx_w_holt <- holt(tx_white, alpha = 0.8, beta = 0.2, initial = "simple", h = 5)
plot(tx_w_holt, plot.conf=FALSE, type="o")
lines(fitted(tx_w_holt), col="blue", type="o")
res_txw_holt=residuals(tx_w_holt)
Box.test(res_txw_holt,type="L")

tx_black <- Texas[,"Num.Black"]

tx_b_ses <- ses(tx_black, alpha = 0.5, initial = "simple", h = 5)
plot(tx_b_ses, plot.conf=FALSE, type="o")
lines(fitted(tx_b_ses), col="blue", type="o")
res_txb_ses=residuals(tx_b_ses)
Box.test(res_txb_ses)

tx_b_holt <-holt(tx_black, alpha = 0.8, beta = 0.2, initial = "simple", h = 5)
plot(tx_b_holt, plot.conf=FALSE, type="o")
lines(fitted(tx_b_holt), col="blue", type="o")
res_txb_holt=residuals(tx_b_holt)
Box.test(res_txb_holt,type="L")

Age_Num$Family <- Age_Num$Num.Children.0.18*4
tx_fam <- ts(Age_Num[485:495,"Family"], start = 2008, end = 2018, frequency = 1)

fam_ses <- ses(tx_fam, alpha = 0.5, initial = "simple", h = 5)
plot(fam_ses, plot.conf=FALSE, type="o")
lines(fitted(fam_ses), col="blue", type="o")
res_fam_ses=residuals(fam_ses)
Box.test(res_fam_ses)

fam_holt <-holt(tx_fam, alpha = 0.8, beta = 0.2, initial = "simple", h = 5)
plot(fam_holt, plot.conf=FALSE, type="o")
lines(fitted(fam_holt), col="blue", type="o")
res_fam_holt=residuals(fam_holt)
Box.test(res_fam_holt,type="L")

tx_asian <- Texas[,"Num.Asian.Native.Hawaiian.and.Pacific.Islander"]

tx_a_ses <- ses(tx_asian, alpha = 0.5, initial = "simple", h = 5)
plot(tx_a_ses, plot.conf=FALSE, type="o")
lines(fitted(tx_a_ses), col="blue", type="o")
res_txa_ses=residuals(tx_a_ses)
Box.test(res_txa_ses)

tx_a_holt <-holt(tx_asian, alpha = 0.8, beta = 0.2, initial = "simple", h = 5)
plot(tx_a_holt, plot.conf=FALSE, type="o")
lines(fitted(tx_a_holt), col="blue", type="o")
res_txa_holt=residuals(tx_a_holt)
Box.test(res_txa_holt,type="L")

tx_am_indian <- Texas[,"Num.American.Indian.Alaska.Native"]

tx_ai_ses <- ses(tx_am_indian, alpha = 0.5, initial = "simple", h = 5)
plot(tx_ai_ses, plot.conf=FALSE, type="o")
lines(fitted(tx_ai_ses), col="blue", type="o")
res_txai_ses=residuals(tx_ai_ses)
Box.test(res_txai_ses)

tx_ai_holt <-holt(tx_am_indian, alpha = 0.8, beta = 0.2, initial = "simple", h = 5)
plot(tx_ai_holt, plot.conf=FALSE, type="o")
lines(fitted(tx_ai_holt), col="blue", type="o")
res_txai_holt=residuals(tx_ai_holt)
Box.test(res_txai_holt,type="L")

tx_mult <- Texas[,"Num.Multiple.Races"]

tx_m_ses <- ses(tx_mult, alpha = 0.5, initial = "simple", h = 5)
plot(tx_m_ses, plot.conf=FALSE, type="o")
lines(fitted(tx_m_ses), col="blue", type="o")
res_txm_ses=residuals(tx_m_ses)
Box.test(res_txm_ses)

tx_m_holt <-holt(tx_mult, alpha = 0.8, beta = 0.2, initial = "simple", h = 5)
plot(tx_m_holt, plot.conf=FALSE, type="o")
lines(fitted(tx_m_holt), col="blue", type="o")
res_txm_holt=residuals(tx_m_holt)
Box.test(res_txm_holt,type="L")
```

## Uninsured Forecasting Florida
```{r message=FALSE, warning=FALSE}
fl_white <- Florida[,"Num.White"]

fl_w_ses <- ses(fl_white, alpha = 0.5, initial = "simple", h = 5)
plot(fl_w_ses, plot.conf=FALSE, type="o")
lines(fitted(fl_w_ses), col="blue", type="o")
res_fw_ses=residuals(fl_w_ses)
Box.test(res_fw_ses,type="L")

fl_w_holt <- holt(fl_white, alpha = 0.8, beta = 0.2, initial = "simple", h = 5)
plot(fl_w_holt, plot.conf=FALSE, type="o")
lines(fitted(fl_w_holt), col="blue", type="o")
res_fw_holt=residuals(fl_w_holt)
Box.test(res_fw_holt,type="L")

fl_hispanic <- Florida[,"Num.Hispanic"]

fl_h_ses <- ses(fl_hispanic, alpha = 0.5, initial = "simple", h = 5)
plot(fl_h_ses, plot.conf=FALSE, type="o")
lines(fitted(fl_h_ses), col="blue", type="o")
res_fh_ses=residuals(fl_h_ses)
Box.test(res_fh_ses)

fl_h_holt <-holt(fl_hispanic, alpha = 0.8, beta = 0.2, initial = "simple", h = 5)
plot(fl_h_holt, plot.conf=FALSE, type="o")
lines(fitted(fl_h_holt), col="blue", type="o")
res_fh_holt=residuals(fl_h_holt)
Box.test(res_fh_holt,type="L")

fl_black <- Florida[,"Num.Black"]

fl_b_ses <- ses(fl_black, alpha = 0.5, initial = "simple", h = 5)
plot(fl_b_ses, plot.conf=FALSE, type="o")
lines(fitted(fl_b_ses), col="blue", type="o")
res_fb_ses=residuals(fl_b_ses)
Box.test(res_fb_ses)

fl_b_holt <-holt(fl_black, alpha = 0.8, beta = 0.2, initial = "simple", h = 5)
plot(fl_b_holt, plot.conf=FALSE, type="o")
lines(fitted(fl_b_holt), col="blue", type="o")
res_fb_holt=residuals(fl_b_holt)
Box.test(res_fb_holt,type="L")

fl_asian <- Florida[,"Num.Asian.Native.Hawaiian.and.Pacific.Islander"]

fl_a_ses <- ses(fl_asian, alpha = 0.5, initial = "simple", h = 5)
plot(fl_a_ses, plot.conf=FALSE, type="o")
lines(fitted(fl_a_ses), col="blue", type="o")
res_fla_ses=residuals(fl_a_ses)
Box.test(res_fla_ses)

fl_a_holt <-holt(fl_asian, alpha = 0.8, beta = 0.2, initial = "simple", h = 5)
plot(fl_a_holt, plot.conf=FALSE, type="o")
lines(fitted(fl_a_holt), col="blue", type="o")
res_fla_holt=residuals(fl_a_holt)
Box.test(res_fla_holt,type="L")

fl_am_indian <- Florida[,"Num.American.Indian.Alaska.Native"]

fl_ai_ses <- ses(fl_am_indian, alpha = 0.5, initial = "simple", h = 5)
plot(fl_ai_ses, plot.conf=FALSE, type="o")
lines(fitted(fl_ai_ses), col="blue", type="o")
res_flai_ses=residuals(fl_ai_ses)
Box.test(res_flai_ses)

fl_ai_holt <-holt(fl_am_indian, alpha = 0.8, beta = 0.2, initial = "simple", h = 5)
plot(fl_ai_holt, plot.conf=FALSE, type="o")
lines(fitted(fl_ai_holt), col="blue", type="o")
res_flai_holt=residuals(fl_ai_holt)
Box.test(res_flai_holt,type="L")

fl_mult <- Florida[,"Num.Multiple.Races"]

fl_m_ses <- ses(fl_mult, alpha = 0.5, initial = "simple", h = 5)
plot(fl_m_ses, plot.conf=FALSE, type="o")
lines(fitted(fl_m_ses), col="blue", type="o")
res_flm_ses=residuals(fl_m_ses)
Box.test(res_flm_ses)

fl_m_holt <-holt(fl_mult, alpha = 0.8, beta = 0.2, initial = "simple", h = 5)
plot(fl_m_holt, plot.conf=FALSE, type="o")
lines(fitted(fl_m_holt), col="blue", type="o")
res_flm_holt=residuals(fl_m_holt)
Box.test(res_flm_holt,type="L")
```

## Uninsured Forecasting Other recommended states
```{r message=FALSE, warning=FALSE}
g_white <- Georgia[,"Num.White"]

g_w_holt <- holt(g_white, alpha = 0.8, beta = 0.2, initial = "simple", h = 5)
plot(g_w_holt, plot.conf=FALSE, type="o")
lines(fitted(g_w_holt), col="blue", type="o")
res_gw_holt=residuals(g_w_holt)
Box.test(res_gw_holt,type="L")

g_black <- Georgia[,"Num.Black"]

g_b_holt <- holt(g_black, alpha = 0.8, beta = 0.2, initial = "simple", h = 5)
plot(g_b_holt, plot.conf=FALSE, type="o")
lines(fitted(g_b_holt), col="blue", type="o")
res_gb_holt=residuals(g_b_holt)
Box.test(res_gb_holt,type="L")

g_hispanic <- Georgia[,"Num.Hispanic"]

g_h_holt <- holt(g_hispanic, alpha = 0.8, beta = 0.2, initial = "simple", h = 5)
plot(g_h_holt, plot.conf=FALSE, type="o")
lines(fitted(g_h_holt), col="blue", type="o")
res_gh_holt=residuals(g_h_holt)
Box.test(res_gh_holt,type="L")

v_white <- Virginia[,"Num.White"]

v_w_holt <- holt(v_white, alpha = 0.8, beta = 0.2, initial = "simple", h = 5)
plot(v_w_holt, plot.conf=FALSE, type="o")
lines(fitted(v_w_holt), col="blue", type="o")
res_vw_holt=residuals(v_w_holt)
Box.test(res_vw_holt,type="L")

v_black <- Virginia[,"Num.Black"]

v_b_holt <- holt(v_black, alpha = 0.8, beta = 0.2, initial = "simple", h = 5)
plot(v_b_holt, plot.conf=FALSE, type="o")
lines(fitted(v_b_holt), col="blue", type="o")
res_vb_holt=residuals(v_b_holt)
Box.test(res_vb_holt,type="L")

v_hispanic <- Virginia[,"Num.Hispanic"]

v_h_holt <- holt(v_hispanic, alpha = 0.8, beta = 0.2, initial = "simple", h = 5)
plot(v_h_holt, plot.conf=FALSE, type="o")
lines(fitted(v_h_holt), col="blue", type="o")
res_vh_holt=residuals(v_h_holt)
Box.test(res_vh_holt,type="L")

mary_hispanic <- Maryland[,"Num.Hispanic"]

m_h_holt <- holt(mary_hispanic, alpha = 0.8, beta = 0.2, initial = "simple", h = 5)
plot(m_h_holt, plot.conf=FALSE, type="o")
lines(fitted(m_h_holt), col="blue", type="o")
res_mh_holt=residuals(v_h_holt)
Box.test(res_mh_holt,type="L")
```


###Underinsured Converting the Dataframe into Time Series data type
```{r}
AL <- ts(EmpSpon[1:11,-c(1:2)], start = 2008, end = 2018, frequency = 1)
AK <- ts(EmpSpon[12:22,-c(1:2)], start = 2008, end = 2018, frequency = 1)
AZ <- ts(EmpSpon[23:33,-c(1:2)], start = 2008, end = 2018, frequency = 1)
AR <- ts(EmpSpon[34:44,-c(1:2)], start = 2008, end = 2018, frequency = 1)
CA <- ts(EmpSpon[45:55,-c(1:2)], start = 2008, end = 2018, frequency = 1)
CO <- ts(EmpSpon[56:66,-c(1:2)], start = 2008, end = 2018, frequency = 1)
CT <- ts(EmpSpon[67:77,-c(1:2)], start = 2008, end = 2018, frequency = 1)
DE <- ts(EmpSpon[78:88,-c(1:2)], start = 2008, end = 2018, frequency = 1)
DC <- ts(EmpSpon[89:99,-c(1:2)], start = 2008, end = 2018, frequency = 1)
FL <- ts(EmpSpon[100:110,-c(1:2)], start = 2008, end = 2018, frequency = 1)
GA <- ts(EmpSpon[111:121,-c(1:2)], start = 2008, end = 2018, frequency = 1)
HI <- ts(EmpSpon[122:132,-c(1:2)], start = 2008, end = 2018, frequency = 1)
ID <- ts(EmpSpon[133:143,-c(1:2)], start = 2008, end = 2018, frequency = 1)
IL <- ts(EmpSpon[144:154,-c(1:2)], start = 2008, end = 2018, frequency = 1)
IN <- ts(EmpSpon[155:165,-c(1:2)], start = 2008, end = 2018, frequency = 1)
IA <- ts(EmpSpon[166:176,-c(1:2)], start = 2008, end = 2018, frequency = 1)
KS <- ts(EmpSpon[177:187,-c(1:2)], start = 2008, end = 2018, frequency = 1)
KY <- ts(EmpSpon[188:198,-c(1:2)], start = 2008, end = 2018, frequency = 1)
LA <- ts(EmpSpon[199:209,-c(1:2)], start = 2008, end = 2018, frequency = 1)
ME <- ts(EmpSpon[210:220,-c(1:2)], start = 2008, end = 2018, frequency = 1)
MD <- ts(EmpSpon[221:231,-c(1:2)], start = 2008, end = 2018, frequency = 1)
MA <- ts(EmpSpon[232:242,-c(1:2)], start = 2008, end = 2018, frequency = 1)
MI <- ts(EmpSpon[243:253,-c(1:2)], start = 2008, end = 2018, frequency = 1)
MN <- ts(EmpSpon[254:264,-c(1:2)], start = 2008, end = 2018, frequency = 1)
MS <- ts(EmpSpon[265:275,-c(1:2)], start = 2008, end = 2018, frequency = 1)
MO <- ts(EmpSpon[276:286,-c(1:2)], start = 2008, end = 2018, frequency = 1)
MT <- ts(EmpSpon[287:297,-c(1:2)], start = 2008, end = 2018, frequency = 1)
NE <- ts(EmpSpon[298:308,-c(1:2)], start = 2008, end = 2018, frequency = 1)
NV <- ts(EmpSpon[309:319,-c(1:2)], start = 2008, end = 2018, frequency = 1)
NH <- ts(EmpSpon[320:330,-c(1:2)], start = 2008, end = 2018, frequency = 1)
NJ <- ts(EmpSpon[331:341,-c(1:2)], start = 2008, end = 2018, frequency = 1)
NM <- ts(EmpSpon[342:352,-c(1:2)], start = 2008, end = 2018, frequency = 1)
NY <- ts(EmpSpon[353:363,-c(1:2)], start = 2008, end = 2018, frequency = 1)
NC <- ts(EmpSpon[364:374,-c(1:2)], start = 2008, end = 2018, frequency = 1)
ND <- ts(EmpSpon[375:385,-c(1:2)], start = 2008, end = 2018, frequency = 1)
OH <- ts(EmpSpon[386:396,-c(1:2)], start = 2008, end = 2018, frequency = 1)
OK <- ts(EmpSpon[397:407,-c(1:2)], start = 2008, end = 2018, frequency = 1)
OR <- ts(EmpSpon[408:418,-c(1:2)], start = 2008, end = 2018, frequency = 1)
PA <- ts(EmpSpon[419:429,-c(1:2)], start = 2008, end = 2018, frequency = 1)
PR <- ts(EmpSpon[430:440,-c(1:2)], start = 2008, end = 2018, frequency = 1)
RI <- ts(EmpSpon[441:451,-c(1:2)], start = 2008, end = 2018, frequency = 1)
SC <- ts(EmpSpon[452:462,-c(1:2)], start = 2008, end = 2018, frequency = 1)
SD <- ts(EmpSpon[463:473,-c(1:2)], start = 2008, end = 2018, frequency = 1)
TN <- ts(EmpSpon[474:484,-c(1:2)], start = 2008, end = 2018, frequency = 1)
TX <- ts(EmpSpon[485:495,-c(1:2)], start = 2008, end = 2018, frequency = 1)
US <- ts(EmpSpon[496:506,-c(1:2)], start = 2008, end = 2018, frequency = 1)
UT <- ts(EmpSpon[507:517,-c(1:2)], start = 2008, end = 2018, frequency = 1)
VT <- ts(EmpSpon[518:528,-c(1:2)], start = 2008, end = 2018, frequency = 1)
VA <- ts(EmpSpon[529:539,-c(1:2)], start = 2008, end = 2018, frequency = 1)
WA <- ts(EmpSpon[540:550,-c(1:2)], start = 2008, end = 2018, frequency = 1)
WV <- ts(EmpSpon[551:561,-c(1:2)], start = 2008, end = 2018, frequency = 1)
WI <- ts(EmpSpon[562:572,-c(1:2)], start = 2008, end = 2018, frequency = 1)
WY <- ts(EmpSpon[573:583,-c(1:2)], start = 2008, end = 2018, frequency = 1)
```
### Running the Forecasting tools on time series 
There was no seaonality in the data so used Holt's method. We ran all three models of Holt's method that is Simple model, Multiplicative model and Damped model. To check the stability of the model we used Box Ljung test. The model was aceptable if there was no auto correlation in the residuals. So the Hypothesis was there is no auto correlation in the residuals. Accept Ho if p-value > 0.05.

#### United States Of America
USA totals don't include Puerto Rico
```{r}
sub_US <- US[,3] #restricting the time-series to only one column
#Holts Method for SES
fit1 = holt(sub_US, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_US, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_US, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_US, ylab="US Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.5,.6), main="Plot of US Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_us<- holt(sub_US, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_us <- predict(m_us,prediction.interval = TRUE)
write.csv(p_us, "emp_united_states.csv")
```


#### Underinsured Forcast Alabama
```{r}
sub_AL <- AL[,3] #restricting the time-series to only one column
#Holts Method for SES
fit1 = holt(sub_AL, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_AL, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_AL, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_AL, ylab="Alabama Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.10,.70), main="Plot of Alabama Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_al<- holt(sub_AL, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_al <- predict(m_al,prediction.interval = TRUE)
write.csv(p_al, "emp_alabama.csv")
p_al
```

#Underinsured forcast Alaska
```{r}
sub_AK <- AK[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_AK, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_AK, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_AK, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_AK, ylab="Alaska Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.10,.70), main="Plot of Alaska Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_ak<- holt(sub_AK, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_ak <- predict(m_ak,prediction.interval = TRUE)
write.csv(p_ak, "emp_alaska.csv")
```

##Underinsured Forcast Arizona
```{r}
sub_AZ <- AZ[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_AZ, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_AZ, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_AZ, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_AZ, ylab="Arizona Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.10,.70), main="Plot of Arizona Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_az<- holt(sub_AZ, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_az <- predict(m_az,prediction.interval = TRUE)
write.csv(p_az, "emp_arizona.csv")
```

##Underinsured Forcast Arkansas
```{r}
sub_AR <- AR[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_AR, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_AR, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_AR, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_AR, ylab="Arkansas Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.45,.55), main="Plot of Arkansaa Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_ar<- holt(sub_AR, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_ar <- predict(m_ar,prediction.interval = TRUE)
write.csv(p_ar, "emp_arkansas.csv")
```

#Underinsured Forcast California
```{r}
sub_CA <- CA[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_CA, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_CA, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_CA, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_CA, ylab="California Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.40,.70), main="Plot of California Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_ca<- holt(sub_CA, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_ca <- predict(m_ca,prediction.interval = TRUE)
write.csv(p_ca, "emp_california.csv")
```

#Underinsured Forcast Colarado
```{r}
sub_CO <- CO[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_CO, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_CO, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_CO, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_CO, ylab="Colarado Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.40,.70), main="Plot of Colarado Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_co<- holt(sub_CO, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_co<- predict(m_co,prediction.interval = TRUE)
write.csv(p_co, "emp_colorado.csv")
```


#Underinsured Forcast Connecticut
```{r}
sub_CT <- CT[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_CT, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_CT, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_CT, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_CT, ylab="Connecticut Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.40,.70), main="Plot of Connecticut Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_ct<- holt(sub_CT, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_ct<- predict(m_ct,prediction.interval = TRUE)
write.csv(p_ct, "emp_connecticut.csv")
```

#Underinsured Forcast Delaware
```{r}
sub_DE <- DE[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_DE, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_DE, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_DE, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_DE, ylab="Delaware Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.40,.70), main="Plot of Delaware Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_de<- holt(sub_DE, alpha = 0.8, beta = 0.2,initial = "simple",h=6)
p_de<- predict(m_de,prediction.interval = TRUE)
write.csv(p_de, "emp_delaware.csv")
```

#Underinsured Forcast District Of Columbia
```{r}
sub_DC <- DC[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_DC, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_DC, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_DC, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_DC, ylab="District of Columbia Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.30,.70), main="Plot of District of Columbia Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_dc<- holt(sub_DC, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_dc<- predict(m_dc,prediction.interval = TRUE)
write.csv(p_dc, "emp_District_of_Columbia.csv")
```

#Underinsured Forcast Florida
```{r}
sub_FL <- FL[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_FL, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_FL, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_FL, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_FL, ylab="Florida Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.40,.60), main="Plot of Florida Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_fl<- holt(sub_FL, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_fl<- predict(m_fl,prediction.interval = TRUE)
write.csv(p_fl, "emp_florida.csv")
```

#Underinsured Georgia
```{r}
sub_GA <- GA[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_GA, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_GA, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_GA, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_GA, ylab="Georgia Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.40,.70), main="Plot of Georgia Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_ga<- holt(sub_GA, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_ga<- predict(m_ga,prediction.interval = TRUE)
write.csv(p_ga, "emp_georgia.csv")
```

#Underinsured Forcast Hawaii
```{r}
sub_HI <- HI[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_HI, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_HI, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_HI, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_HI, ylab="Hawaii Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.50,.70), main="Plot of Hawaii Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_hi<- holt(sub_HI, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_hi<- predict(m_hi,prediction.interval = TRUE)
write.csv(p_hi, "emp_hawaii.csv")
```

#Underinsured Forcast Idaho
```{r}
sub_ID <- ID[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_ID, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_ID, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_ID, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_ID, ylab="Idaho Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.30,.70), main="Plot of Idaho Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_id<- holt(sub_ID, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_id<- predict(m_id,prediction.interval = TRUE)
write.csv(p_id, "emp_idaho.csv")
```

#Underinsured Forcast Illinois
```{r}
sub_IL <- IL[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_IL, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_IL, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_IL, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_IL, ylab="Illinois Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.30,.70), main="Plot of Illinois Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_il<- holt(sub_IL, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_il<- predict(m_il,prediction.interval = TRUE)
write.csv(p_il, "emp_illinois.csv")
```

#Underinsured Forcast Indiana
```{r}
sub_IN <- IN[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_IN, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_IN, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_IN, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_IN, ylab="Indiana Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.30,.70), main="Plot of Indiana Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_in<- holt(sub_IN, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_in<- predict(m_in,prediction.interval = TRUE)
write.csv(p_in, "emp_indiana.csv")
```

#Underinsured Forcast Iowa
```{r}
sub_IA <- IA[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_IA, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_IA, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_IA, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_IA, ylab="Iowa Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.30, .70), main="Plot of Iowa Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_ia<- holt(sub_IA, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_ia<- predict(m_ia,prediction.interval = TRUE)
write.csv(p_ia, "emp_iowa.csv")
```

#Underinsured Forcast Kansas
```{r}
sub_KS <- KS[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_KS, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_KS, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_KS, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_KS, ylab="Kansas Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.30,.70), main="Plot of Kansas Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_ks<- holt(sub_KS, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_ks<- predict(m_ks,prediction.interval = TRUE)
write.csv(p_ks, "emp_kansas.csv")
```

#Underinsured Forcast Kentucky
```{r}
sub_KY <- KY[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_KY, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_KY, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_KY, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_KY, ylab="Kentucky Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.30,.70), main="Plot of Kentucky Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_ky<- holt(sub_KY, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_ky<- predict(m_ky,prediction.interval = TRUE)
write.csv(p_ky, "emp_kentucky.csv")
```

#Underinsured Forcast Louisiana
```{r}
sub_LA <- LA[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_LA, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_LA, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_LA, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_LA, ylab="Louisiana Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.30,.70), main="Plot of Louisiana Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_la<- holt(sub_LA, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_la<- predict(m_la,prediction.interval = TRUE)
write.csv(p_la, "emp_louisiana.csv")
```

#Underinsured Forcast Maine
```{r}
sub_ME <- ME[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_ME, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_ME, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_ME, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_ME, ylab="Maine Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.30,.70), main="Plot of Maine Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_me<- holt(sub_ME, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_me<- predict(m_me,prediction.interval = TRUE)
write.csv(p_me, "emp_maine.csv")
```

#Underinsured Forcast Maryland
```{r}
sub_MD <- MD[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_MD, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_MD, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_MD, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_MD, ylab="Maryland Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.30,.70), main="Plot of Maryland Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_md<- holt(sub_MD, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_md<- predict(m_md,prediction.interval = TRUE)
write.csv(p_md, "emp_maryland.csv")
```

#Underinsured Forcast Massachusetts
```{r}
sub_MA <- MA[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_MA, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_MA, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_MA, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_MA, ylab="Massachusetts Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.30,.70), main="Plot of Massachusetts Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_ma<- holt(sub_MA, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_ma<- predict(m_ma,prediction.interval = TRUE)
write.csv(p_ma, "emp_massachusetts.csv")
```

#Underinsured Forcast Michigan
```{r}
sub_MI <- MI[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_MI, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_MI, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_MI, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_MI, ylab="Michigan Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.30,.70), main="Plot of Michigan Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_mi<- holt(sub_MI, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_mi<- predict(m_mi,prediction.interval = TRUE)
write.csv(p_mi, "emp_michigan.csv")
```

#Underinsured Forcast Minnesota
```{r}
sub_MN <- MN[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_MN, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_MN, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_MN, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_MN, ylab="Minnesota Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.30,.70), main="Plot of Minnesota Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_mn<- holt(sub_MN, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_mn<- predict(m_mn,prediction.interval = TRUE)
write.csv(p_mn, "emp_minnesota.csv")
```

#Underinsured Forcast Mississippi
```{r}
sub_MS <- MS[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_MS, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_MS, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_MS, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_MS, ylab="Mississippi Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.30,.70), main="Plot of Mississippi Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_ms<- holt(sub_MS, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_ms<- predict(m_ms,prediction.interval = TRUE)
write.csv(p_ms, "emp_mississippi.csv")
```

#Underinsured Forcast Missouri
```{r}
sub_MO <- MO[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_MO, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_MO, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_MO, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_MO, ylab="Missouri Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.30,.70), main="Plot of Missouri Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_mo<- holt(sub_MO, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_mo<- predict(m_mo,prediction.interval = TRUE)
write.csv(p_mo, "emp_missouri.csv")
```

#Underinsured Forcast Montana
```{r}
sub_MT <- MT[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_MT, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_MT, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_MT, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_MT, ylab="Montana Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.30,.70), main="Plot of Montana Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_mt<- holt(sub_MT, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_mt<- predict(m_mt,prediction.interval = TRUE)
write.csv(p_mt, "emp_montana.csv")
```

#Underinsured Forcast Nebraska
```{r}
sub_NE <- NE[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_NE, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_NE, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_NE, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_NE, ylab="Nebraska Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.30,.70), main="Plot of Nebraska Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_ne<- holt(sub_NE, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_ne<- predict(m_ne,prediction.interval = TRUE)
write.csv(p_ne, "emp_nebraska.csv")
```

#Underinsured Forcast Nevada
```{r}
sub_NV <- NV[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_NV, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_NV, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_NV, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_NV, ylab="Nevada Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.30,.70), main="Plot of Nevada Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_nv<- holt(sub_NV, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_nv<- predict(m_nv,prediction.interval = TRUE)
write.csv(p_nv, "emp_nevada.csv")
```

#Underinsured Forcast New Hampshire
```{r}
sub_NH <- NH[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_NH, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_NH, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_NH, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_NH, ylab="New Hampshire Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.30,.70), main="Plot of New Hampshire Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_nh<- holt(sub_NH, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_nh<- predict(m_nh,prediction.interval = TRUE)
write.csv(p_nh, "emp_new_hampshire.csv")
```

#Underinsured Forcast New Jersey
```{r}
sub_NJ<- NJ[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_NJ, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_NJ, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_NJ, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_NJ, ylab="New Jersey Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.30,.70), main="Plot of New Jersey Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_nj<- holt(sub_NJ, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_nj<- predict(m_nj,prediction.interval = TRUE)
write.csv(p_nj, "emp_new_jersey.csv")
```

#Underinsured Forcast New Mexico
```{r}
sub_NM<- NM[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_NM, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_NM, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_NM, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_NM, ylab="New Mexico Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.30,.50), main="Plot of New Mexico Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_nm<- holt(sub_NM, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_nm<- predict(m_nm,prediction.interval = TRUE)
write.csv(p_nm, "emp_new_mexico.csv")
```

#Underinsured Forcast New York
```{r}
sub_NY<- NY[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_NY, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_NY, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_NY, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_NY, ylab="New York Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.40,.70), main="Plot of New York Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_ny<- holt(sub_NY, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_ny<- predict(m_ny,prediction.interval = TRUE)
write.csv(p_ny, "emp_new_york.csv")
```

#Underinsured Forcast North Carolina
```{r}
sub_NC<- NC[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_NC, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_NC, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_NC, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_NC, ylab="North Carolina Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.40,.70), main="Plot of North Carolina Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_nc<- holt(sub_NC, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_nc<- predict(m_nc,prediction.interval = TRUE)
write.csv(p_nc, "emp_north_carolina.csv")
```

#Underinsured Forcast North Dakota
```{r}
sub_ND<- ND[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_ND, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_ND, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_ND, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_ND, ylab="North Dakota Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.40,.70), main="Plot of North Dakota Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_nd<- holt(sub_ND, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_nd<- predict(m_nd,prediction.interval = TRUE)
write.csv(p_nd, "emp_north_dakota.csv")
```

#Underinsured Forcast Ohio
```{r}
sub_OH<- OH[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_OH, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_OH, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_OH, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_OH, ylab="Ohio Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.40,.70), main="Plot of Ohio Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_oh<- holt(sub_OH, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_oh<- predict(m_oh,prediction.interval = TRUE)
write.csv(p_oh, "emp_ohio.csv")
```

#Underinsured Forcast Oklahoma
```{r}
sub_OK<- OK[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_OK, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_OK, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_OK, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_OK, ylab="Oklahoma Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.40,.70), main="Plot of Oklahoma Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_ok<- holt(sub_OK, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_ok<- predict(m_ok,prediction.interval = TRUE)
write.csv(p_ok, "emp_oklahoma.csv")
```

#Underinsured Forcast Oregon
```{r}
sub_OR<- OR[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 =holt(sub_OR, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_OR, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 =holt(sub_OR, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_OR, ylab="Oregon Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.40,.70), main="Plot of Oregon Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_or<- holt(sub_OR, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_or<- predict(m_or,prediction.interval = TRUE)
write.csv(p_or, "emp_oregon.csv")
```


#Underinsured Forcast Pennsylvania
```{r}
sub_PA<- PA[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 =holt(sub_PA, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_PA, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 =holt(sub_PA, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_PA, ylab="Pennsylvania Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.40,.70), main="Plot of Pennsylvania Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_pa<- holt(sub_PA, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_pa<- predict(m_pa,prediction.interval = TRUE)
write.csv(p_pa, "emp_pennsylvania.csv")
```

#Underinsured Forcast Puerto Rico
```{r}
sub_PR<- PR[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 =holt(sub_PR, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_PR, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 =holt(sub_PR, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_PR, ylab="Puerto Rico Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.20,.40), main="Plot of Puerto Rico Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_pr<- holt(sub_PR, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_pr<- predict(m_pr,prediction.interval = TRUE)
write.csv(p_pr, "emp_puerto_rico.csv")
```

#Underinsured Forcast Rhode Island
```{r}
sub_RI<- RI[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 =holt(sub_RI, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_RI, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 =holt(sub_RI, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_RI, ylab="Rhode Island Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.40,.70), main="Plot of Rhode Island Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_ri<- holt(sub_RI, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_ri<- predict(m_ri,prediction.interval = TRUE)
write.csv(p_ri, "emp_rhode_island.csv")
```

#Underinsured Forcast South Carolina
```{r}
sub_SC<- SC[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_SC, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_SC, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_SC, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_SC, ylab="South Carolina Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.40,.70), main="Plot of South Carolina Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_sc<- holt(sub_SC, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_sc<- predict(m_sc,prediction.interval = TRUE)
write.csv(p_sc, "emp_south_carolina.csv")
```

#Underinsured Forcast South Dakota
```{r}
sub_SD<- SD[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_SD, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_SD, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_SD, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_SD, ylab="South Dakota Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.40,.70), main="Plot of South Dakota Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_sd<- holt(sub_SD, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_sd<- predict(m_sd,prediction.interval = TRUE)
write.csv(p_sd, "emp_south_dakota.csv")
```

#Underinsured Forcast Tennessee
```{r}
sub_TN<- TN[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 =holt(sub_TN, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_TN, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 =holt(sub_TN, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_TN, ylab="Tennessee Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.40,.70), main="Plot of Tennessee Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_tn<- holt(sub_TN, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_tn<- predict(m_tn,prediction.interval = TRUE)
write.csv(p_tn, "emp_tennessee.csv")
```

#Underinsured Forcast Texas
```{r}
sub_TX<- TX[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 =holt(sub_TX, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_TX, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 =holt(sub_TX, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_TX, ylab="Texas Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.40,.70), main="Plot of Texas Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_tx<- holt(sub_TX, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_tx<- predict(m_tx,prediction.interval = TRUE)
write.csv(p_tx, "emp_texas.csv")
```

#Underinsured Forcast Utah
```{r}
sub_UT<- UT[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 =holt(sub_UT, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_UT, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 =holt(sub_UT, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_UT, ylab="Utah Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.40,.70), main="Plot of Utah Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_ut<- holt(sub_UT, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_ut<- predict(m_ut,prediction.interval = TRUE)
write.csv(p_ut, "emp_utah.csv")
```

#Underinsured Forcast Vermont
```{r}
sub_VT<- VT[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 =holt(sub_VT, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_VT, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 =holt(sub_VT, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_VT, ylab="Vermont Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.40,.70), main="Plot of Vermont Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_vt<- holt(sub_VT, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_vt<- predict(m_vt,prediction.interval = TRUE)
write.csv(p_vt, "emp_vermont.csv")
```

#Underinsured Forcast Virginia
```{r}
sub_VA<- VA[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 =holt(sub_VA, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_VA, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 =holt(sub_VA, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_VA, ylab="Virginia Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.40,.70), main="Plot of Virginia Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_va<- holt(sub_VA, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_va<- predict(m_va,prediction.interval = TRUE)
write.csv(p_va, "emp_virginia.csv")
```

#Underinsured Forcast Washington
```{r}
sub_WA<- WA[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 =holt(sub_WA, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_WA, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 =holt(sub_WA, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_WA, ylab="Washington Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.40,.70), main="Plot of Washington Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_wa<- holt(sub_WA, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_wa<- predict(m_wa,prediction.interval = TRUE)
write.csv(p_wa, "emp_washington.csv")
```

#Underinsured Forcast West Virginia
```{r}
sub_WV<- WV[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 =holt(sub_WV, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_WV, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 =holt(sub_WV, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_WV, ylab="West Virginia Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.40,.70), main="Plot of West Virginia Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_wv<- holt(sub_WV, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_wv<- predict(m_wv,prediction.interval = TRUE)
write.csv(p_wv, "emp_west_virginia.csv")
```

#Underinsured Forcast Wisconsin
```{r}
sub_WI<- WI[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 =holt(sub_WI, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_WI, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 =holt(sub_WI, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_WI, ylab="Wisconsin Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.40,.70), main="Plot of Wisconsin Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_wi<- holt(sub_WI, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_wi<- predict(m_wi,prediction.interval = TRUE)
write.csv(p_wi, "emp_wisconsin.csv")
```

#Underinsured Forcast Wyoming
```{r}
sub_WY<- WY[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 =holt(sub_WY, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_WY, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 =holt(sub_WY, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_WY, ylab="Wyoming Employee Sponsor Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.40,.70), main="Plot of Wyoming Employee Sponsor Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_wy<- holt(sub_WY, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_wy<- predict(m_wy,prediction.interval = TRUE)
write.csv(p_wy, "emp_wyoming.csv")
```


### Medicaid Forcast
```{r}
## Proportion of Population on Medicaid
### Converting DataFrame into Time Series Data
Alabama <- ts(RateMedi[1:11,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Alaska <- ts(RateMedi[12:22,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Arizona <- ts(RateMedi[23:33,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Arkansas <- ts(RateMedi[34:44,-c(1:2)], start = 2008, end = 2018, frequency = 1)
California <- ts(RateMedi[45:55,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Colorado <- ts(RateMedi[56:66,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Connecticut <- ts(RateMedi[67:77,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Delaware <- ts(RateMedi[78:88,-c(1:2)], start = 2008, end = 2018, frequency = 1)
DistrictC <- ts(RateMedi[89:99,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Florida <- ts(RateMedi[100:110,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Georgia <- ts(RateMedi[111:121,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Hawaii <- ts(RateMedi[122:132,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Idaho <- ts(RateMedi[133:143,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Illinois <- ts(RateMedi[144:154,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Indiana <- ts(RateMedi[155:165,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Iowa <- ts(RateMedi[166:176,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Kansas <- ts(RateMedi[177:187,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Kentucky <- ts(RateMedi[188:198,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Louisiana <- ts(RateMedi[199:209,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Maine <- ts(RateMedi[210:220,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Maryland <- ts(RateMedi[221:231,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Massachusetts <- ts(RateMedi[232:242,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Michigan <- ts(RateMedi[243:253,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Minnesota <- ts(RateMedi[254:264,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Mississippi <- ts(RateMedi[265:275,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Missouri <- ts(RateMedi[276:286,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Montana <- ts(RateMedi[287:297,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Nebraska <- ts(RateMedi[298:308,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Nevada <- ts(RateMedi[309:319,-c(1:2)], start = 2008, end = 2018, frequency = 1)
New_Hampshire <- ts(RateMedi[320:330,-c(1:2)], start = 2008, end = 2018, frequency = 1)
New_Jersey <- ts(RateMedi[331:341,-c(1:2)], start = 2008, end = 2018, frequency = 1)
New_Mexico <- ts(RateMedi[342:352,-c(1:2)], start = 2008, end = 2018, frequency = 1)
New_York <- ts(RateMedi[353:363,-c(1:2)], start = 2008, end = 2018, frequency = 1)
North_Carolina <- ts(RateMedi[364:374,-c(1:2)], start = 2008, end = 2018, frequency = 1)
North_Dakota <- ts(RateMedi[375:385,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Ohio <- ts(RateMedi[386:396,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Oklahoma <- ts(RateMedi[397:407,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Oregon <- ts(RateMedi[408:418,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Pennsylvania <- ts(RateMedi[419:429,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Puerto_Rico <- ts(RateMedi[430:440,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Rhode_Island <- ts(RateMedi[441:451,-c(1:2)], start = 2008, end = 2018, frequency = 1)
South_Carolina <- ts(RateMedi[452:462,-c(1:2)], start = 2008, end = 2018, frequency = 1)
South_Dakota <- ts(RateMedi[463:473,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Tennessee <- ts(RateMedi[474:484,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Texas <- ts(RateMedi[485:495,-c(1:2)], start = 2008, end = 2018, frequency = 1)
United_States_entire <- ts(RateMedi[496:506,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Utah <- ts(RateMedi[507:517,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Vermont <- ts(RateMedi[518:528,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Virginia <- ts(RateMedi[529:539,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Washington <- ts(RateMedi[540:550,-c(1:2)], start = 2008, end = 2018, frequency = 1)
West_Virginia <- ts(RateMedi[551:561,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Wisconsin <- ts(RateMedi[562:572,-c(1:2)], start = 2008, end = 2018, frequency = 1)
Wyoming <- ts(RateMedi[573:583,-c(1:2)], start = 2008, end = 2018, frequency = 1)
```
### Running the Forecasting tools on time series 
There was no seaonality in the data so used Holt's method. We ran all three models of Holt's method that is Simple model, Multiplicative model and Damped model. To check the stability of the model we used Box Ljung test. The model was aceptable if there was no auto correlation in the residuals. So the Hypothesis was there is no auto correlation in the residuals. Accept Ho if p-value > 0.05.


#### United States Of America Medicaid Rate
USA totals don't include Puerto Rico
```{r}
sub_US <- United_States_entire[,3] #restricting the time-series to only one column
#Holts Method for SES
fit1 = holt(sub_US, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_US, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_US, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_US, ylab="US Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.10,.35), main="Plot of US Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_us<- holt(sub_US, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_us <- predict(m_us,prediction.interval = TRUE)
write.csv(p_us, "p_united_states.csv")
```

### Alabama Medicaid Rate
```{r}
sub_Alabama <- Alabama[,3] #restricting the time-series to only one column
#Holts Method for SES
fit1 = holt(sub_Alabama, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_Alabama, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_Alabama, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_Alabama, ylab="Alabama Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.10,.35), main="Plot of Alabama Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_al<- holt(sub_Alabama, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_al <- predict(m_al,prediction.interval = TRUE)
write.csv(p_al, "p_alabama.csv")
```

#### Alaska Medicaid Rate
```{r}
sub_Alaska <- Alaska[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_Alaska, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_Alaska, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_Alaska, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_Alaska, ylab="Alaska Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.10,.45), main="Plot of Alaska Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_ak<- holt(sub_Alaska, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_ak <- predict(m_ak,prediction.interval = TRUE)
write.csv(p_ak, "p_alaska.csv")
```

#### Arizona Medicaid Rate
```{r}
sub_Arizona <- Arizona[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_Arizona, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_Arizona, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_Arizona, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_Arizona, ylab="Arizona Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.10,.35), main="Plot of Arizona Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_az<- holt(sub_Arizona, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_az <- predict(m_az,prediction.interval = TRUE)
write.csv(p_az, "p_arizona.csv")
```

#### Arkansas Medicaid Rate
```{r}
sub_Arkansas <- Arkansas[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_Arkansas, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_Arkansas, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_Arkansas, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_Arkansas, ylab="Arkansas Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.10,.45), main="Plot of Arkansaa Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_ar<- holt(sub_Arkansas, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_ar <- predict(m_ar,prediction.interval = TRUE)
write.csv(p_ar, "p_arkansas.csv")
```

#### California Medicaid Rate
```{r}
sub_California <- California[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_California, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_California, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_California, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_California, ylab="California Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.10,.45), main="Plot of California Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_ca<- holt(sub_California, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_ca <- predict(m_ca,prediction.interval = TRUE)
write.csv(p_ca, "p_california.csv")
```

#### Colarado Medicaid Rate
```{r}
sub_Colorado <- Colorado[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_Colorado, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_Colorado, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_Colorado, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_Colorado, ylab="Colarado Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.10,.40), main="Plot of Colarado Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_co<- holt(sub_Colorado, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_co<- predict(m_co,prediction.interval = TRUE)
write.csv(p_co, "p_colorado.csv")
```

#### Connecticut Medicaid Rate
```{r}
sub_Connecticut <- Connecticut[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_Connecticut, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_Connecticut, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_Connecticut, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_Connecticut, ylab="Connecticut Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.10,.40), main="Plot of Connecticut Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_ct<- holt(sub_Connecticut, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_ct<- predict(m_ct,prediction.interval = TRUE)
write.csv(p_ct, "p_connecticut.csv")
```

#### Delaware Medicaid Rate
```{r}
sub_Delaware <- Delaware[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_Delaware, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_Delaware, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_Delaware, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_Delaware, ylab="Delaware Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.10,.40), main="Plot of Delaware Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_de<- holt(sub_Delaware, alpha = 0.8, beta = 0.2,initial = "simple",h=6)
p_de<- predict(m_de,prediction.interval = TRUE)
write.csv(p_de, "p_delaware.csv")
```

#### District Of Columbia Medicaid Rate
```{r}
sub_dc<- DistrictC[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_dc, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 = holt(sub_dc, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_dc, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_dc, ylab="District Of Columbia Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.05,.40), main="Plot of District Of Columbia Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_dc<- holt(sub_dc, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_dc<- predict(m_dc,prediction.interval = TRUE)
write.csv(p_dc, "p_district_c.csv")
```

#### Florida Medicaid Rate
```{r}
sub_FL<- Florida[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_FL, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_FL, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_FL, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_FL, ylab="Florida Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.10,.30), main="Plot of Florida Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_fl<- holt(sub_FL, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_fl<- predict(m_fl,prediction.interval = TRUE)
write.csv(p_fl, "p_florida.csv")
```

#### Gerogia Medicaid Rate
```{r}
sub_GA<- Georgia[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_GA, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_GA, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_GA, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_GA, ylab="Gerogia Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.10,.30), main="Plot of Gerogia Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_ga<- holt(sub_GA, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_ga<- predict(m_ga,prediction.interval = TRUE)
write.csv(p_ga, "p_georgia.csv")
```

#### Hawaii Medicaid Rate
```{r}
sub_HI<- Hawaii[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_HI, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_HI, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_HI, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_HI, ylab="Hawaii Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.10,.30), main="Plot of Hawaii Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_hi<- holt(sub_HI, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_hi<- predict(m_hi,prediction.interval = TRUE)
write.csv(p_hi, "p_hawaii.csv")
```

#### Idaho Medicaid Rate
```{r}
sub_ID<- Idaho[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_ID, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_ID, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_ID, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_ID, ylab="Idaho Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.10,.30), main="Plot of Idaho Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_id<- holt(sub_ID, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_id<- predict(m_id,prediction.interval = TRUE)
write.csv(p_id, "p_idaho.csv")
```

#### Illinois Medicaid Rate
```{r}
sub_Illinois <- Illinois[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_Illinois, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_Illinois, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_Illinois, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_Illinois, ylab="Illinois Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.10,.30), main="Plot of Illinois Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_il<- holt(sub_Illinois, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_il<- predict(m_il,prediction.interval = TRUE)
write.csv(p_il, "p_illinois.csv")
```

#### Indiana Medicaid Rate
```{r}
sub_IN<- Indiana[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_IN, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_IN, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_IN, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_IN, ylab="Indiana Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.10,.30), main="Plot of Indiana Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_in<- holt(sub_IN, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_in<- predict(m_in,prediction.interval = TRUE)
write.csv(p_in, "p_indiana.csv")
```

#### Iowa Medicaid Rate
```{r}
sub_IA<- Iowa[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_IA, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_IA, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_IA, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_IA, ylab="Iowa Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.10,.30), main="Plot of Iowa Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_ia<- holt(sub_IA, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_ia<- predict(m_ia,prediction.interval = TRUE)
write.csv(p_ia, "p_iowa.csv")
```

#### Kansas Medicaid Rate
```{r}
sub_Kansas <- Kansas[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_Kansas, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_Kansas, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_Kansas, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_Kansas, ylab="Kansas Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.10,.30), main="Plot of Kansas Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_ks<- holt(sub_Kansas, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_ks<- predict(m_ks,prediction.interval = TRUE)
write.csv(p_ks, "p_kansas.csv")
````

#### Kentucky Medicaid Rate
```{r}
sub_Kentucky <- Kentucky[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_Kentucky, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_Kentucky, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_Kentucky, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_Kentucky, ylab="Kentucky Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.10,.50), main="Plot of Kentucky Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_ky<- holt(sub_Kentucky, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_ky<- predict(m_ky,prediction.interval = TRUE)
write.csv(p_ky, "p_kentucky.csv")
```

#### Louisiana Medicaid Rate
```{r}
sub_Louisiana <- Louisiana[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_Louisiana, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_Louisiana, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_Louisiana, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_Louisiana, ylab="Louisiana Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.10,.50), main="Plot of Louisiana Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_la<- holt(sub_Louisiana, alpha = 0.8, beta = 0.2,initial = "simple",h=6)
p_la<- predict(m_la,prediction.interval = TRUE)
write.csv(p_la, "p_louisiana.csv")
```

#### Maine Medicaid Rate
```{r}
sub_Maine <- Maine[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_Maine, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_Maine, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_Maine, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_Maine, ylab="Maine Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.10,.30), main="Plot of Maine Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_me<- holt(sub_Maine, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_me<- predict(m_me,prediction.interval = TRUE)
write.csv(p_me, "p_maine.csv")
```

#### Maryland Medicaid Rate
```{r}
sub_Maryland <- Maryland[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_Maryland, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_Maryland, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_Maryland, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_Maryland, ylab="Maryland Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.10,.30), main="Plot of Maryland Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_md<- holt(sub_Maryland, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_md<- predict(m_md,prediction.interval = TRUE)
write.csv(p_md, "p_maryland.csv")
```

#### Massachusetts Medicaid Rate
```{r}
sub_ma<- Massachusetts[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_ma, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_ma, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_ma, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_ma, ylab="Massachusetts Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.10,.35), main="Plot of Massachusetts Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_ma<- holt(sub_ma, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_ma<- predict(m_ma,prediction.interval = TRUE)
write.csv(p_ma, "p_massachusetts.csv")
```

#### Michigan Medicaid Rate
```{r}
sub_mi<- Michigan[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_mi, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_mi, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_mi, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_mi, ylab="Michigan Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.10,.30), main="Plot of Michigan Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_mi<- holt(sub_mi, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_mi<- predict(m_mi,prediction.interval = TRUE)
write.csv(p_mi, "p_michigan.csv")
```

#### Minnesota Medicaid Rate
```{r}
sub_mn<- Minnesota[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_mn, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_mn, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_mn, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_mn, ylab="Minnesota Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.10,.30), main="Plot of Minnesota Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_mn<- holt(sub_mn, alpha = 0.8, beta = 0.2,initial = "simple",h=6)
p_mn<- predict(m_mn,prediction.interval = TRUE)
write.csv(p_mn, "p_minnesota.csv")
```

#### Mississippi Medicaid Rate
```{r}
sub_ms<- Mississippi[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_ms, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_ms, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_ms, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_ms, ylab="Mississippi Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.10,.30), main="Plot of Mississippi Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_ms<- holt(sub_ms, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_ms<- predict(m_ms,prediction.interval = TRUE)
write.csv(p_ms, "p_mississippi.csv")
```

#### Missouri Medicaid Rate
```{r}
sub_mo<- Missouri[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_mo, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_mo, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_mo, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_mo, ylab="Missouri Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.10,.20), main="Plot of Missouri Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_mo<- holt(sub_mo, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_mo<- predict(m_mo,prediction.interval = TRUE)
write.csv(p_mo, "p_missouri.csv")
```

#### Montana Medicaid Rate
```{r}
sub_mt<- Montana[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_mt, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_mt, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_mt, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_mt, ylab="Montana Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.10,.40), main="Plot of Montana Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_mt<- holt(sub_mt, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_mt<- predict(m_mt,prediction.interval = TRUE)
write.csv(p_mt, "p_montana.csv")
```

#### Nebraska Medicaid Rate
```{r}
sub_ne<- Nebraska[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_ne, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_ne, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_ne, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_ne, ylab="Nebraska Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.10,.20), main="Plot of Nebraska Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_ne<- holt(sub_ne, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_ne<- predict(m_ne,prediction.interval = TRUE)
write.csv(p_ne, "p_nebraska.csv")
```

#### Nevada Medicaid Rate
```{r}
sub_nv<- Nevada[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_nv, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_nv, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_nv, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_nv, ylab="Nevada Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.10,.40), main="Plot of Nevada Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_nv<- holt(sub_nv, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_nv<- predict(m_nv,prediction.interval = TRUE)
write.csv(p_nv, "p_nevada.csv")
```

#### New Hampshire Medicaid Rate
```{r}
sub_nh<- New_Hampshire[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_nh, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_nh, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_nh, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_nh, ylab="New Hampshire Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.10,.30), main="Plot of New Hampshire Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_nh<- holt(sub_nh, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_nh<- predict(m_nh,prediction.interval = TRUE)
write.csv(p_nh, "p_new_hampshire.csv")
```

#### New Jersey Medicaid Rate
```{r}
sub_nj<- New_Jersey[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_nj, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_nj, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_nj, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_nj, ylab="New Jersey Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.10,.30), main="Plot of New Jersey Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_nj<- holt(sub_nj, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_nj<- predict(m_nj,prediction.interval = TRUE)
write.csv(p_nj, "p_new_jersey.csv")
```

#### New Mexico Medicaid Rate
```{r}
sub_nm<- New_Mexico[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_nm, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_nm, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_nm, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_nm, ylab="New Mexico Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.10,.30), main="Plot of New Mexico Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_nm<- holt(sub_nm, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_nm<- predict(m_nm,prediction.interval = TRUE)
write.csv(p_nm, "p_new_mexico.csv")
```

#### New York Medicaid Rate
```{r}
sub_ny<- New_York[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_ny, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_ny, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_ny, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_ny, ylab="New York Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.10,.30), main="Plot of New York Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_ny<- holt(sub_ny, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_ny<- predict(m_ny,prediction.interval = TRUE)
write.csv(p_ny, "p_new_york.csv")
```

#### North Carolina Medicaid Rate
```{r}
sub_nc<- North_Carolina[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_nc, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_nc, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_nc, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_nc, ylab="North Carolina Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.10,.30), main="Plot of North Carolina Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_nc<- holt(sub_nc, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_nc<- predict(m_nc,prediction.interval = TRUE)
write.csv(p_nc, "p_north_carolina.csv")
```

#### North Dakota Medicaid Rate
```{r}
sub_nd<- North_Dakota[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_nd, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_nd, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_nd, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_nd, ylab="North Dakota Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.01,.20), main="Plot of North Dakota Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_nd<- holt(sub_nd, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_nd<- predict(m_nd,prediction.interval = TRUE)
write.csv(p_nd, "p_north_dakota.csv")
```

#### Ohio Medicaid Rate
```{r}
sub_oh<- Ohio[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_oh, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_oh, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_oh, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_oh, ylab="Ohio Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.10,.40), main="Plot of Ohio Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_oh<- holt(sub_oh, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_oh<- predict(m_oh,prediction.interval = TRUE)
write.csv(p_oh, "p_ohio.csv")
```

#### Oklahoma Medicaid Rate
```{r}
sub_ok<- Oklahoma[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_ok, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_ok, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_ok, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_ok, ylab="Oklahoma Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.10,.30), main="Plot of Oklahoma Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_ok<- holt(sub_ok, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_ok<- predict(m_ok,prediction.interval = TRUE)
write.csv(p_ok, "p_oklahoma.csv")
```

#### Pennsylvania Medicaid Rate
```{r}
sub_pa<- Pennsylvania[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_pa, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_pa, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_pa, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_pa, ylab="Pennsylvania Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.10,.35), main="Plot of Pennsylvania Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_pa<- holt(sub_pa, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_pa<- predict(m_pa,prediction.interval = TRUE)
write.csv(p_pa, "p_pennsylvania.csv")
```

#### Puerto Rico Medicaid Rate
```{r}
sub_pr<- Puerto_Rico[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_pr, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 = holt(sub_pr, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_pr, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_pr, ylab="Puerto Rico Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.10,.60), main="Plot of Puerto Rico Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_pr<- holt(sub_pr, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_pr<- predict(m_pr,prediction.interval = TRUE)
write.csv(p_pr, "p_puerto_rico.csv")
```

#### Rhode Island Medicaid Rate
```{r}
sub_ri<- Rhode_Island[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_ri, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_ri, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_ri, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_ri, ylab="Rhode Island Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.10,.40), main="Plot of Rhode Island Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_ri<- holt(sub_ri, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_ri<- predict(m_ri,prediction.interval = TRUE)
write.csv(p_ri, "p_rhode_island.csv")
```

#### South Carolina Medicaid Rate
```{r}
sub_sc<- South_Carolina[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_sc, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_sc, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_sc, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_sc, ylab="South Carolina Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.10,.40), main="Plot of South Carolina Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_sc<- holt(sub_sc, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_sc<- predict(m_sc,prediction.interval = TRUE)
write.csv(p_sc, "p_south_carolina.csv")
```

#### South Dakota Medicaid Rate
```{r}
sub_sd<- South_Dakota[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_sd, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 = holt(sub_sd, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_sd, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_sd, ylab="South Dakota Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.05,.20), main="Plot of South Dakota Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_sd<- holt(sub_sd, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_sd<- predict(m_sd,prediction.interval = TRUE)
write.csv(p_sd, "p_south_dakota.csv")
```

#### Tennessee Medicaid Rate
```{r}
sub_tn<- Tennessee[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_tn, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 = holt(sub_tn, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_tn, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_tn, ylab="Tennessee Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.05,.20), main="Plot of Tennessee Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_tn<- holt(sub_tn, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_tn<- predict(m_tn,prediction.interval = TRUE)
write.csv(p_tn, "p_tennessee.csv")
```

#### Texas Medicaid Rate
```{r}
sub_tx<- Texas[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_tx, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 = holt(sub_tx, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_tx, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_tx, ylab="Texas Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.05,.30), main="Plot of Texas Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_tx<- holt(sub_tx, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_tx<- predict(m_tx,prediction.interval = TRUE)
write.csv(p_tx, "p_texas.csv")
```

#### Utah Medicaid Rate
```{r}
sub_ut<- Utah[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_ut, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 = holt(sub_ut, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_ut, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_ut, ylab="Utah Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.05,.15), main="Plot of Utah Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_ut<- holt(sub_ut, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_ut<- predict(m_ut,prediction.interval = TRUE)
write.csv(p_ut, "p_utah.csv")
```

#### Vermont Medicaid Rate
```{r}
sub_vt<- Vermont[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_vt, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 = holt(sub_vt, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_vt, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_vt, ylab="Vermont Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.05,.45), main="Plot of Vermont Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_vt<- holt(sub_vt, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_vt<- predict(m_ut,prediction.interval = TRUE)
write.csv(p_vt, "p_vermont.csv")
```

#### Virginia Medicaid Rate
```{r}
sub_va<- Virginia[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_va, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 = holt(sub_va, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_va, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_va, ylab="Virginia Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.05,.20), main="Plot of Virginia Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_va<- holt(sub_va, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_va<- predict(m_va,prediction.interval = TRUE)
write.csv(p_va, "p_virginia.csv")
```

#### Washington Medicaid Rate
```{r}
sub_WA<- Washington[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_WA, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_WA, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_WA, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_WA, ylab="Washington Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.10,.30), main="Plot of washington Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_wa<- holt(sub_WA, alpha = 0.8, beta = 0.2, initial = "simple",h=6)
p_wa<- predict(m_wa,prediction.interval = TRUE)
write.csv(p_wa, "p_washington.csv")
```

#### West Virginia Medicaid Rate
```{r}
sub_wv<- West_Virginia[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_wv, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 = holt(sub_wv, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_wv, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_wv, ylab="West Virginia Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.05,.45), main="Plot of West VirginiaMedicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_wv<- holt(sub_wv, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_wv<- predict(m_wv,prediction.interval = TRUE)
write.csv(p_wv, "p_west_virginia.csv")
```

#### Wisconsin Medicaid Rate
```{r}
sub_wi<- Wisconsin[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_wi, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 = holt(sub_wi, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_wi, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_wi, ylab="Wisconsin Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.05,.40), main="Plot of Wisconsin Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_wi<- holt(sub_wi, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_wi<- predict(m_wi,prediction.interval = TRUE)
write.csv(p_wi, "p_wisconsin.csv")
```

#### Wyoming Medicaid Rate
```{r}
sub_wy<- Wyoming[,3] #restricting the time-series to only one column

#Holts Method for SES
fit1 = holt(sub_wy, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 = holt(sub_wy, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
fit3 = holt(sub_wy, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "optimal", h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_wy, ylab="Wyoming Medicaid Rate-standardized Holts Method",
     xlab="Year",xlim=c(2008.0,2025.0),ylim=c(.05,.20), main="Plot of Wyoming Medicaid Rate", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red","green"), 
       c("data", expression(simple), expression(multipicative),
         expression(damped)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)
res.fit3=residuals(fit3)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")
Box.test(res.fit3,type="L")

m_wy<- holt(sub_wy, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_wy<- predict(m_wy,prediction.interval = TRUE)
write.csv(p_wy, "p_wyoming.csv")
```
## Percent of Private Firms which provide Insurance Cover to their Employees

### Converting the DataFrame into Time Series Data
```{r}
PvtAL <- ts(PvtFirmCov[1:7,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtAK <- ts(PvtFirmCov[8:14,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtAZ <- ts(PvtFirmCov[15:21,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtAR <- ts(PvtFirmCov[22:28,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtCA <- ts(PvtFirmCov[29:35,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtCO <- ts(PvtFirmCov[36:42,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtCT <- ts(PvtFirmCov[43:49,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtDE <- ts(PvtFirmCov[50:56,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtDC <- ts(PvtFirmCov[57:63,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtFL <- ts(PvtFirmCov[64:70,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtGA <- ts(PvtFirmCov[71:77,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtHI <- ts(PvtFirmCov[78:84,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtID <- ts(PvtFirmCov[85:91,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtIL <- ts(PvtFirmCov[92:98,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtIN <- ts(PvtFirmCov[99:105,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtIA <- ts(PvtFirmCov[106:112,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtKS <- ts(PvtFirmCov[113:119,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtKY <- ts(PvtFirmCov[120:126,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtLA <- ts(PvtFirmCov[127:133,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtME <- ts(PvtFirmCov[134:140,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtMD <- ts(PvtFirmCov[141:147,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtMA <- ts(PvtFirmCov[148:154,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtMI <- ts(PvtFirmCov[155:161,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtMN <- ts(PvtFirmCov[162:168,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtMS <- ts(PvtFirmCov[169:175,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtMO <- ts(PvtFirmCov[176:182,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtMT <- ts(PvtFirmCov[183:189,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtNE <- ts(PvtFirmCov[190:196,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtNV <- ts(PvtFirmCov[197:203,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtNH <- ts(PvtFirmCov[204:210,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtNJ <- ts(PvtFirmCov[211:217,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtNM <- ts(PvtFirmCov[218:224,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtNY <- ts(PvtFirmCov[225:231,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtNC <- ts(PvtFirmCov[232:238,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtND <- ts(PvtFirmCov[239:245,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtOH <- ts(PvtFirmCov[246:252,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtOK <- ts(PvtFirmCov[253:259,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtOR <- ts(PvtFirmCov[260:266,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtPA <- ts(PvtFirmCov[267:273,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtRI <- ts(PvtFirmCov[274:280,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtSC <- ts(PvtFirmCov[281:287,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtSD <- ts(PvtFirmCov[288:294,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtTN <- ts(PvtFirmCov[295:301,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtTX <- ts(PvtFirmCov[302:308,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtUS <- ts(PvtFirmCov[309:315,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtUT <- ts(PvtFirmCov[316:322,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtVT <- ts(PvtFirmCov[323:329,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtVA <- ts(PvtFirmCov[330:336,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtWA <- ts(PvtFirmCov[337:343,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtWV <- ts(PvtFirmCov[344:350,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtWI <- ts(PvtFirmCov[351:357,-c(1:2)], start = 2012, end = 2018, frequency = 1)
PvtWY <- ts(PvtFirmCov[358:364,-c(1:2)], start = 2012, end = 2018, frequency = 1)
```
### Running the Forecasting tools on time series 
There was no seaonality in the data so used Holt's method. We ran all three models of Holt's method that is Simple model, and Multiplicative model. We could not run the *Damped Model* on this time series as we kept getting a message the time series is short for a damped model to do accurate predictions. To check the stability of the model we used Box Ljung test. The model was aceptable if there was no auto correlation in the residuals. So the Hypothesis was there is no auto correlation in the residuals. Accept Ho if p-value > 0.05.
We looked at the firms with less than 50 employees as the data for firms more than 50 employees was very good due to the Affordable Care Act.
Also there is no information about Puerto Rico

#### United States Of America Percent of Pvt Firms with < 50 Employees
```{r}
sub_US <- PvtUS[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 = holt(sub_US, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_US, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_US, ylab="US Pvt Firms with < 50 Employees Pctt-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.20,.40), main="Plot of US Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_us<- holt(sub_US, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_us <- predict(m_us,prediction.interval = TRUE)
write.csv(p_us, "pvt_united_states.csv")
```

#### Alabama Precent of Pvt Firms with < 50 Employees
```{r}
sub_AL <- PvtAL[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 = holt(sub_AL, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_AL, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_AL, ylab="Alabama Private Firms with Less than 50 Employees Percent -standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.20,.40), main="Plot of Alabama Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_al<- holt(sub_AL, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_al <- predict(m_al,prediction.interval = TRUE)
write.csv(p_al, "pvt_alabama.csv")
```

#### Alaska Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_AK <- PvtAK[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_AK, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_AK, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_AK, ylab="Alaska Private Firms with Less than 50 Employees Percent Rate-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.10,.30), main="Plot of Alaska Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_ak<- holt(sub_AK, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_ak<- predict(m_ak,prediction.interval = TRUE)
write.csv(p_ak, "pvt_alaska.csv")
```

#### Arizona Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_AZ <- PvtAZ[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_AZ, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_AZ, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_AZ, ylab="Arizon Private Firms with Less than 50 Employees Percent Rate-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.10,.30), main="Plot of Arizona Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_az<- holt(sub_AZ, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_az<- predict(m_az,prediction.interval = TRUE)
write.csv(p_az, "pvt_arizona.csv")
```

#### Arkansas Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_AR <- PvtAR[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_AR, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_AR, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_AR, ylab="Arkansas Private Firms with Less than 50 Employees Percent Rate-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.10,.30), main="Plot of Arkansas Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_ar<- holt(sub_AR, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_ar<- predict(m_ar,prediction.interval = TRUE)
write.csv(p_ar, "pvt_arkansas.csv")
```

#### California Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_CA <- PvtCA[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_CA, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_CA, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_CA, ylab="California Private Firms with Less than 50 Employees Percent Rate-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.10,.50), main="Plot of California Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_ca<- holt(sub_CA, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_ca<- predict(m_ca,prediction.interval = TRUE)
write.csv(p_ca, "pvt_california.csv")
```

#### Colorado Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_CO <- PvtCO[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_CO, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_CO, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_CO, ylab="Colorado Private Firms with Less than 50 Employees Percent Rate-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.10,.50), main="Plot of Colorado Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_co<- holt(sub_CO, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_co<- predict(m_co,prediction.interval = TRUE)
write.csv(p_co, "pvt_colorado.csv")
```

#### Connecticut Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_CT <- PvtCT[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_CT, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_CT, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_CT, ylab="Connecticut Private Firms with Less than 50 Employees Percent Rate-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.10,.50), main="Plot of Connecticut Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_ct<- holt(sub_CT, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_ct<- predict(m_ct,prediction.interval = TRUE)
write.csv(p_ct, "pvt_connecticut.csv")
```

#### Delware Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_DE <- PvtDE[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_DE, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_DE, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_DE, ylab="Delaware Private Firms with Less than 50 Employees Percent Rate-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.05,.45), main="Plot of Delaware Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_de<- holt(sub_DE, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_de<- predict(m_de,prediction.interval = TRUE)
write.csv(p_de, "pvt_delaware.csv")
```

#### District of Columbia Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_DC <- PvtDC[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_DC, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_DC, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_DC, ylab="District of Columbia Private Firms with Less than 50 Employees Percent Rate-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.10,.7), main="Plot of District of Columbia Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_dc<- holt(sub_DC, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_dc<- predict(m_dc,prediction.interval = TRUE)
write.csv(p_dc, "pvt_district_c.csv")
```

#### Florida Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_FL<- PvtFL[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_FL, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_FL, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_FL, ylab="Florida Private Firms with Less than 50 Employees Percent Rate-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.10,.50), main="Plot of Florida Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_fl<- holt(sub_FL, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_fl<- predict(m_fl,prediction.interval = TRUE)
write.csv(p_fl, "pvt_florida.csv")
```

#### Georgia Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_GA <- PvtGA[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_GA, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_GA, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_GA, ylab="Georgia Private Firms with Less than 50 Employees Percent Rate-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.05,.35), main="Plot of Georgia Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_ga<- holt(sub_GA, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_ga<- predict(m_ga,prediction.interval = TRUE)
write.csv(p_ga, "pvt_georgia.csv")
```

#### Hawaii Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_HI <- PvtHI[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_HI, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_HI, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_HI, ylab="Hawaii Private Firms with Less than 50 Employees Percent Rate-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.6,.85), main="Plot of Hawaii Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_hi<- holt(sub_HI, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_hi<- predict(m_hi,prediction.interval = TRUE)
write.csv(p_hi, "pvt_hawaii.csv")
```

#### Idaho Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_ID <- PvtID[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_ID, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_ID, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_ID, ylab="Idaho < 50 Employees Percent Rate-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.1,.5), main="Plot of Idaho Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_id<- holt(sub_ID, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_id<- predict(m_id,prediction.interval = TRUE)
write.csv(p_id, "pvt_idaho.csv")
```

#### Illinois Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_IL <- PvtIL[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_IL, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_IL, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_IL, ylab="Illinois < 50 Employees Percent-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.1,.5), main="Plot of Illinois Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_il<- holt(sub_IL, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_il<- predict(m_il,prediction.interval = TRUE)
write.csv(p_il, "pvt_illinois.csv")
```

#### Indiana Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_IN <- PvtIN[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_IN, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_IN, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_IN, ylab="Indiana < 50 Employees Percent-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.1,.5), main="Plot of Indiana Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_in<- holt(sub_IN, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_in<- predict(m_in,prediction.interval = TRUE)
write.csv(p_in, "pvt_indiana.csv")
```

#### Iowa Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_IA <- PvtIA[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_IA, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_IA, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_IA, ylab="Iowa < 50 Employees Percent-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.1,.5), main="Plot of Iowa Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_ia<- holt(sub_IA, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_ia<- predict(m_ia,prediction.interval = TRUE)
write.csv(p_ia, "pvt_iowa.csv")
```

#### Kansas Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_KS <- PvtKS[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_KS, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_KS, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_KS, ylab="Kansas < 50 Employees Percent-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.1,.5), main="Plot of Kansas Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_ks<- holt(sub_KS, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_ks<- predict(m_ks,prediction.interval = TRUE)
write.csv(p_ks, "pvt_kansas.csv")
```

#### Kentucky Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_KY <- PvtKY[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_KY, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_KY, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_KY, ylab="Kentucky < 50 Employees Percent-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.1,.5), main="Plot of Kentucky Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_ky<- holt(sub_KY, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_ky<- predict(m_ky,prediction.interval = TRUE)
write.csv(p_ky, "pvt_kentucky.csv")
```

#### Louisiana Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_LA <- PvtLA[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_LA, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_LA, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_LA, ylab="Louisiana < 50 Employees Percent-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.1,.5), main="Plot of Louisiana Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_la<- holt(sub_LA, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_la<- predict(m_la,prediction.interval = TRUE)
write.csv(p_la, "pvt_louisiana.csv")
```

#### Maine Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_ME <- PvtME[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_ME, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_ME, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_ME, ylab="Maine < 50 Employees Percent-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.1,.5), main="Plot of Maine Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_me<- holt(sub_ME, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_me<- predict(m_me,prediction.interval = TRUE)
write.csv(p_me, "pvt_maine.csv")
```

#### Maryland Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_MD<- PvtMD[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_MD, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_MD, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_MD, ylab="Maryland < 50 Employees Percent-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.1,.5), main="Plot of Maryland Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_md<- holt(sub_MD, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_md<- predict(m_md,prediction.interval = TRUE)
write.csv(p_md, "pvt_maryland.csv")
```

#### Massachuetts Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_MA<- PvtMA[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_MA, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_MA, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_MA, ylab="Massachuetts < 50 Employees Percent-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.1,.6), main="Plot of Massachuetts Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_ma<- holt(sub_MA, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_ma<- predict(m_ma,prediction.interval = TRUE)
write.csv(p_ma, "pvt_massachuetts.csv")
```

#### Michigan Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_MI<- PvtMI[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_MI, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_MI, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_MI, ylab="Michigan < 50 Employees Percent-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.1,.6), main="Plot of Michigan Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_mi<- holt(sub_MI, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_mi<- predict(m_mi,prediction.interval = TRUE)
write.csv(p_mi, "pvt_michigan.csv")
```

#### Minnesota Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_MN<- PvtMN[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_MN, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_MN, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_MN, ylab="Minnesota < 50 Employees Percent-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.1,.6), main="Plot of Minnesota Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_mn<- holt(sub_MN, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_mn<- predict(m_mn,prediction.interval = TRUE)
write.csv(p_mn, "pvt_minnesota.csv")
```

#### Mississippi Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_MS<- PvtMS[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_MS, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_MS, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_MS, ylab="Mississippi < 50 Employees Percent-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.1,.6), main="Plot of Mississippi Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_ms<- holt(sub_MS, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_ms<- predict(m_ms,prediction.interval = TRUE)
write.csv(p_ms, "pvt_mississippi.csv")
```

#### Missouri Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_MO<- PvtMO[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_MO, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_MO, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_MO, ylab="Missouri < 50 Employees Percent-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.1,.6), main="Plot of Missouri Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_mo<- holt(sub_MO, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_mo<- predict(m_mo,prediction.interval = TRUE)
write.csv(p_mo, "pvt_missouri.csv")
```

#### Montana Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_MT<- PvtMT[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_MT, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_MT, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_MT, ylab="Montana < 50 Employees Percent-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.1,.4), main="Plot of Montana Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_mt<- holt(sub_MT, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_mt<- predict(m_mt,prediction.interval = TRUE)
write.csv(p_mt, "pvt_montana.csv")
```

#### Nebraska Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_NE<- PvtNE[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_NE, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_NE, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_NE, ylab="Nebraska < 50 Employees Percent-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.1,.4), main="Plot of Nebraska Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_ne<- holt(sub_NE, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_ne<- predict(m_ne,prediction.interval = TRUE)
write.csv(p_ne, "pvt_nebraska.csv")
```

#### Nevada Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_NV<- PvtNV[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_NV, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_NV, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_NV, ylab="Nevada < 50 Employees Percent-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.1,.4), main="Plot of Nevada Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_nv<- holt(sub_NV, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_nv<- predict(m_nv,prediction.interval = TRUE)
write.csv(p_nv, "pvt_nevada.csv")
```

#### New Hampshire Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_NH<- PvtNH[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_NH, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_NH, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_NH, ylab="New Hampshire < 50 Employees Percent-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.1,.4), main="Plot of New Hampshire Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_nh<- holt(sub_NH, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_nh<- predict(m_nh,prediction.interval = TRUE)
write.csv(p_nh, "pvt_new_hampshire.csv")
```

#### New Jersey Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_NJ<- PvtNJ[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_NJ, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_NJ, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_NJ, ylab="New Jersey < 50 Employees Percent-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.1,.5), main="Plot of New Jersey Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_nj<- holt(sub_NJ, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_nj<- predict(m_nj,prediction.interval = TRUE)
write.csv(p_nj, "pvt_new_jersey.csv")
```

#### New Mexico Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_NM<- PvtNM[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_NM, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_NM, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_NM, ylab="New Mexico< 50 Employees Percent-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.1,.5), main="Plot of New Mexico Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_nm<- holt(sub_NM, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_nm<- predict(m_nm,prediction.interval = TRUE)
write.csv(p_nm, "pvt_new_mexico.csv")
```

#### New York Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_NY<- PvtNY[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_NY, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_NY, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_NY, ylab="New York < 50 Employees Percent-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.1,.5), main="Plot of New York Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_ny<- holt(sub_NY, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_ny<- predict(m_ny,prediction.interval = TRUE)
write.csv(p_ny, "pvt_new_york.csv")
```

#### North Carolina Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_NC<- PvtNC[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_NC, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_NC, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_NC, ylab="North Carolina < 50 Employees Percent-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.05,.35), main="Plot of North Carolina Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_nc<- holt(sub_NC, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_nc<- predict(m_nc,prediction.interval = TRUE)
write.csv(p_nc, "pvt_north_carolina.csv")
```

#### North Dakota Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_ND<- PvtND[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_ND, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_ND, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_ND, ylab="North Dakota < 50 Employees Percent-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.1,.6), main="Plot of North Dakota Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_nd<- holt(sub_ND, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_nd<- predict(m_nd,prediction.interval = TRUE)
write.csv(p_nd, "pvt_north_dakota.csv")
```

#### Ohio Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_OH<- PvtOH[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_OH, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_OH, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_OH, ylab="Ohio < 50 Employees Percent-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.1,.5), main="Plot of Ohio Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_oh<- holt(sub_OH, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_oh<- predict(m_oh,prediction.interval = TRUE)
write.csv(p_oh, "pvt_ohio.csv")
```

#### Oklahoma Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_OK<- PvtOK[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_OK, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_OK, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_OK, ylab="Oklahoma < 50 Employees Percent-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.1,.5), main="Plot of Oklahoma Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_ok<- holt(sub_OK, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_ok<- predict(m_ok,prediction.interval = TRUE)
write.csv(p_ok, "pvt_oklahoma.csv")
```

#### Oregon Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_OR<- PvtOR[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_OR, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_OR, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_OR, ylab="Oregon < 50 Employees Percent-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.1,.5), main="Plot of Oregon Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_or<- holt(sub_OR, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_or<- predict(m_or,prediction.interval = TRUE)
write.csv(p_or, "pvt_oregon.csv")
```

#### Pennsylvania Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_PA<- PvtPA[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_PA, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_PA, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_PA, ylab="Pennsylvania < 50 Employees Percent-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.1,.5), main="Plot of Pennsylvania Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_pa<- holt(sub_PA, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_pa<- predict(m_pa,prediction.interval = TRUE)
write.csv(p_pa, "pvt_pennsylvania.csv")
```

#### Rhode Island Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_RI<- PvtRI[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_RI, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_RI, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_RI, ylab="Rhode Island < 50 Employees Percent-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.1,.5), main="Plot of Rhode Island Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_ri<- holt(sub_RI, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_ri<- predict(m_ri,prediction.interval = TRUE)
write.csv(p_ri, "pvt_rhode_island.csv")
```

#### South Carolina Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_SC<- PvtSC[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_SC, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_SC, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_SC, ylab="South Carolina < 50 Employees Percent-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.05,.35), main="Plot of South Carolina Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_sc<- holt(sub_SC, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_sc<- predict(m_sc,prediction.interval = TRUE)
write.csv(p_sc, "pvt_south_carolina.csv")
```

#### south Dakota Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_SD<- PvtSD[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_SD, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_SD, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_SD, ylab="South Dakota < 50 Employees Percent-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.1,.4), main="Plot of South Dakota Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_sd<- holt(sub_SD, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_sd<- predict(m_sd,prediction.interval = TRUE)
write.csv(p_sd, "pvt_south_dakota.csv")
```

#### Tennessee Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_TN<- PvtTN[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_TN, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_TN, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_TN, ylab="Tennessee < 50 Employees Percent-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.1,.5), main="Plot of Tennessee Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_tn<- holt(sub_TN, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_tn<- predict(m_tn,prediction.interval = TRUE)
write.csv(p_tn, "pvt_tennessee.csv")
```

#### Texas Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_TX<- PvtTX[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_TX, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_TX, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_TX, ylab="Texas < 50 Employees Percent-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.1,.5), main="Plot of Texas Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_tx<- holt(sub_TX, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_tx<- predict(m_tx,prediction.interval = TRUE)
write.csv(p_tx, "pvt_texas.csv")
```

#### Utah Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_UT<- PvtUT[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_UT, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_UT, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_UT, ylab="Utah < 50 Employees Percent-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.05,.4), main="Plot of Utah Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_ut<- holt(sub_UT, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_ut<- predict(m_ut,prediction.interval = TRUE)
write.csv(p_ut, "pvt_utah.csv")
```

#### Vermont Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_VT<- PvtVT[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_VT, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_VT, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_VT, ylab="Vermont < 50 Employees Percent-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.05,.45), main="Plot of Vermont Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_vt<- holt(sub_VT, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_vt<- predict(m_vt,prediction.interval = TRUE)
write.csv(p_vt, "pvt_vermont.csv")
```

#### Virginia Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_VA<- PvtVA[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_VA, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_VA, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_VA, ylab="Virginia < 50 Employees Percent-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.05,.45), main="Plot of Virginia Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_va<- holt(sub_VA, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_va<- predict(m_va,prediction.interval = TRUE)
write.csv(p_va, "pvt_virginia.csv")
```

#### Washington Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_WA<- PvtWA[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_WA, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_WA, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_WA, ylab="Washington< 50 Employees Percent-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.05,.45), main="Plot of Washington Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_wa<- holt(sub_WA, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_wa<- predict(m_wa,prediction.interval = TRUE)
write.csv(p_wa, "pvt_washington.csv")
```

#### West Virginia Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_WV<- PvtWV[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_WV, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_WV, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_WV, ylab="West Virginia < 50 Employees Percent-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.05,.45), main="Plot of West Virginia Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_wv<- holt(sub_WV, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_wv<- predict(m_wv,prediction.interval = TRUE)
write.csv(p_wv, "pvt_west_virginia.csv")
```

#### Wisconsin Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_WI<- PvtWI[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_WI, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_WI, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_WI, ylab="Wisconsin < 50 Employees Percent-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.05,.45), main="Plot of Wisconsin Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_wi<- holt(sub_WI, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_wi<- predict(m_wi,prediction.interval = TRUE)
write.csv(p_wi, "pvt_wisconsin.csv")
```

#### Wyoming Percent of Pvt Firms with < 50 Employees Percent
```{r}
sub_WY<- PvtWY[,4] #restricting the time-series to only one column
#Holts Method for SES
fit1 =holt(sub_WY, alpha = 0.8, beta = 0.2, initial = "simple", h = 6)
fit2 =holt(sub_WY, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 6)
plot(fit1, plot.conf=FALSE, type="o")
lines(fitted(fit1), col="blue", type="o")

plot(sub_WY, ylab="Wyoming < 50 Employees Percent-standardized Holts Method",
     xlab="Year",xlim=c(2012.0,2025.0),ylim=c(.05,.45), main="Plot of Wyoming Private Firms with less than 50 Employees Percent", col="black", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
legend("bottomright",lty=1, col=c(1,"blue","red"), 
       c("data", expression(simple), expression(multipicative)),pch=1)

res.fit1=residuals(fit1)
res.fit2=residuals(fit2)

Box.test(res.fit1,type="L")
Box.test(res.fit2,type="L")

m_wy<- holt(sub_WY, alpha = 0.8, beta = 0.2, initial = "simple", h=6)
p_wy<- predict(m_wy,prediction.interval = TRUE)
write.csv(p_wy, "pvt_wyoming.csv")
```

### Metrix connecting all platforms and their different stages
```{r}

```









